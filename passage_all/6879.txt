一种图像数字水印算法及在电子政务中的应用
1 引言
电子政务，就是政府机构应用现代信息和通信技术，将管理和服务通过网络技术进行集成，在互联网上实现政府组织结构和工作流程的优化重组，超越时间和空间及部门之间的分隔限制，向社会提供优质和全方位的、规范而透明的、符合国际水准的管理和服务[1]。我国的电子政务划分为政务内网和政务外网。其中政务内网为涉密网，处理的信息涉及我国的政治、经济、军事秘密,在我国的电子政务中居于核心地位。电子政务内网中的重要信息主要以机密电子文档的形式存在，这些数字化秘密文件的保护问题，成为研究涉密网络的重中之重[2,6]。
迄今，对于数字水印在电子政务中的应用已有一定的研究，文献[2]中提出了一种新的基于数字水印技术的电子政务安全模型，这种模型可有效地控制机密电子文档的传播，但是使用的是最简单的数字水印算法，安全性不高；文献[3]中列举了数字水印在电子政务中的具体应用，如数字产品知识产权保护（版权保护）、图像认证和防止非法篡改，但是没有提出具体的算法。
本文提出了一种数字水印新算法，结合了小波变换、QR分解的特性，这种算法应用于机密文档中可有效保护文档的安全和进行精确的认证。
2 传统的电子政务安全模型
在我国的电子政务技术规划中，电子政务系统是建立在国家信息安全基础设施(NISI)之上的。NISI包括公钥基础设施(PKI) 、授权管理基础设施(PMI)以及可信时间戳服务系统。其中PKI实现用户的身份确认, PMI则在PKI的基础上提供该用户的访问权限确认。这就解决了电子政务中最重要的安全问题：认证和授权[4,7]。
基于公钥基础设施(PKI)的身份认证，以及基于角色的访问控制(RBAC)的结合能够完善地解决机关信息处理的机密性问题。PKI的原理是基于公钥加密体系中密钥的非对称性，由证书授权机构(CA)签发的数字证书来证明用户的身份和自己的公、私钥之间的对应关系。基于角色的访问控制RBAC是一种介于自主访问控制和强制访问控制之间的访问控制策略。在RBAC中,权限赋予角色,角色分配给用户,用户通过角色享有权限,它不直接与权限相关联,能够降低访问控制管理的复杂度，已成为当前公认的最有发展潜力的控制策略[5,8]。
3 本文提出的水印嵌入算法
输入：原始图像I
输出：嵌入水印的图像I'
step1: 对I进行三级离散小波分解， 得到LLi,HLi,LHi,HHi，LLi,HLi,LHi,HHi分别表示低频子带和水平、垂直、对角方向的高频子带图像，i=1,2,3；
step2:利用Canny 算子提取LL3的边缘特征，记为BW；
step3:利用Hash 函数对 进行置乱，记为BW'；
step4:将BW'和LH3进行QR分解
将LJ3和BW'分成N个互不重叠的2×2矩阵，分别记为LH3k和BWk，k=1,2,…,N，依次对每一个LH3k和BWk进行QR分解，即QRE'=LH3k，其中E是对角矩阵，E'表示E的逆矩阵，同理，Q1R1E1'=BWk。
Step5:对水印进行预处理
对R1进行预处理，即依次提取出每一个BWk分解后所得的R1中的非零最小值，将其组成一个一维矩阵，R1={R'1, R'2,…, R'M},再用一个长度为N的伪随机序列S={S1,S2,…,SN},Si{0,1}来优化前面的一维矩阵，通过R1和S的异或操作来优化，即R*=R1?茌S。
step6：水印的具体嵌入
依次用R*中的每个值替换LH3k分解后所得的实非奇异上三角矩阵R中的非零最小值，替换后的R值记为R'，还原LH3k，即LH3k=QR'E'；
step7：三级小波逆变换。
4 水印检测算法
输入：检测图像I'
输出：图像检测结果
step1:对I’进行三级离散小波分解，得到LLi*,HLi*,LHi*, HHi*；
step2:利用Canny算子提取LL3*的边缘特征，记为BW*；
step3:用与嵌入算法相同的Hash函数对BW*进行置乱，记为BW*；
step4:将LHi*和BW**分成N个互不重叠的2×2矩阵，分别记为LHi*和BW**， k=1,2,…,N，依次对每一个LHi*和BW**进行QR分解，分别得到实非奇异上三角矩阵R*和R1*，R*和R1*中的非零最小值分别记为m*、m1*，如果|m*-m1*|<τ说明图像的此部位通过认证，反之是异样矩阵，图像受到攻击，τ是判断因子。通过记录异样矩阵的位置从而定位受攻击的具体部位。
5 实验分析
为了验证方法的有效性和可行性，做了大量的实验.现以“Vegetable”图为例，本文实验全部在Matlab6.5和Photoshop8.0上完成：实验中以512×512大小的灰度图像进行测试，图1表示原始图像；采用‘db1’的小波基对图像进行小波分解；图2表示嵌入水印后的图像，本文算法的PSNR值为40.5790；
在整个算法中，Hash函数作为进行图像完整性判断时的密钥。
对嵌入水印的图像进行了相应的攻击，攻击后按照上文介绍的提取算法进行图像的判断.三级小波变换后低频和中频均是64×64的矩阵，可以分解为1024个互不重叠的2×2小矩阵，可以通过| m*-m1*|<τ所在的矩阵个数来定量的判断图像经受攻击的程度，本文中τ取0.01，图像经过攻击后提取出来的|m*-m1*|<τ所在(非异样)矩阵个数占整个图像的比例如图3所示。
进行的攻击种类有：1) 噪声攻击（系数0.1高斯白噪声,系数0.1～0.6椒盐噪声。系数0.1高斯噪声）；2) 均值滤波(2×2，3×3)；3) 逆(顺)时针旋转（0.1度，0.5度，1度，2度，画布旋转1度）；4) 剪切或篡改；5) 图 像亮度增强10%；6) 图像对比度增强10%；7) 两幅图合并；8) 对嵌入水印图像进行‘hole’因子部分填充；9) JPEG压缩（质量因子为90%,80%,70%,60%,50%）；10) 模糊攻击(1像素运动模糊，1像素径向模糊，1像素高斯模糊)；11)锐化(普通锐化，边缘锐化，USM锐化)；12)缩放（缩小为510×510，是原图的99.22%，放大到520×520，是原图的103.15%）；13)像素移动(水平，垂直)；14)色调均化；15)彩块化；16)添加1%杂色；17)像素长宽比改变为1.1；18)切变；19)系数1水波滤镜；20)反相变换；21)1%挤压；22)8色抖动处理；23)1度旋转扭曲。几种攻击后受攻击图像的PSNR如表1所示。
■
a）噪声 b）均值滤波 c）旋转 d）对图像内容进行窜改
■
e）JEPG压缩 f）象素模糊和象素移动 g）色彩变化和色彩模糊 h）挤压变化等
图3 图像受攻击后非异样矩阵的比例
6 结论
本文提出了一种脆弱水印算法，利用替换的方法把QR分解和水印嵌入结合起来，算法新颖.算法利用图像本身的特征生成水印，载荷非常小，容易实现，嵌入水印后图像降质很少，而且对绝大多数操作都非常敏感，能很好地进行攻击定位，这些良好的性能增加了它的应用范围，虽然本文仅进行了图像实验，但结论同样适用于音频和视频等其它多媒体数据认证.本文的算法可应用于电子政务中，从而很好地保护电子政务中所用数字多媒体文件的安全性，维护所有权人的利益。进一步的改进主要在于区分非恶意攻击和恶意篡改。
参考文献：
[1] 王焕尘.信息技术与电子政务[M].北京：北方交通大学出版社,2003.
[2] 张震,曹军梅,刘兴平.电子政务的数字水印技术安全模型[J].吉首大学学报:自然科学版,2006,27(5):13-16.
[3] 李敏,费耀平.数字水印技术及其在电子政务安全领域的应用[J].信息网络安全,2006(3):1-3.
[4] 朱大力,陈晓苏.基于数字水印技术的电子政务安全模型[J].计算机应用,2005(25):80-81.
[5] 王琳,罗万伯,熊科.结合PKI和RBAC技术的电子政务安全模型[J].信息安全与通信保密,2005(10):23-25.
[6] 单保华,杨冬菊,张利永.一种有盟主的服务虚拟组织模型及其在电子政务中的应用[J].计算机学报,2006(7):1241-1251.
[7] 刘军,吴贵呈,翁亮.安全电子时间戳系统的设计方案[J].通信学报,2003,24(2):64-70.
[8] 莫赓,钟华,魏峻.一个面向电子政务的信息交换与共享平台的设计与实现[J].计算机应用研究,2007,24(5):156-159.