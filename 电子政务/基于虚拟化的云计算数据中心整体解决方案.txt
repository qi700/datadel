基于虚拟化的云计算数据中心整体解决方案
虚拟化和云计算是近年来在IT 界广为流传的术语。数据中心要实现云计算，虚拟化是一个重要的基础，虚拟化本身并不是云计算，而是走向云计算的途径之一。虚拟化让数据中心的计算能力更具有伸缩性，供给也更为灵活，从而可以更好地为云计算服务。面向云计算的数据中心使用“池”的概念，每个池均可实现动态的资源调整，能够实现虚拟资源池中资源的动态调度，以达到调度过程中充分利用资源的能力。1 虚拟化和云计算概述    1.1 虚拟化    虚拟化是一个广义的术语，是指计算在虚拟的基础上而不是真实的基础上运行，是一个为了简化管理、优化资源的解决方案[2]。虚拟化技术可以扩大硬件的容量，简化软件的重新配置过程，把有限的固定的资源根据不同需求进行重新规划以达到最大利用率。虚拟化是业务系统和IT硬件设备间的一次重要解耦，通过虚拟化后业务系统和虚拟资源映射，虚拟资源再和实际物理资源映射，实际的物理资源对业务系统变成黑盒，在逻辑层形成标准化的虚拟资源池。    由于虚拟化技术能够通过资源共享与合并来提高效率并降低成本，它已经被迅速地应用于数据中心与其他设备上。在传统的数据中心，单个应用至少占用1 台物理的计算机资源，这使得大量的计算资源得不到利用。扩展应用时，必须要考虑要选购的物理机器和 CPU 资源，这使得一些应用被搁置。利用虚拟化，可以在1 台物理机上运行多个虚拟机，可在多个环境间共享这一台计算机的资源。不同的虚拟机可以在同一台物理机上运行不同的操作系统以及多个应用程序。    1.2 云计算    云计算已成为 IT 业一个新的发展趋势。云计算将计算任务分布在大量的资源池上，使各种应用系统能够通过网络根据需要获取计算力、存储空间和各种软件服务。所谓云，就是提供资源的网络是一些能自我管理和维护的虚拟计算资源。将其称谓云，既是对那些分布在网络中的成千上万台电脑和服务器连接成一片电脑云的比喻，也是指代数据的计算过程被隐匿起来，由服务器按需要，从整个大云中“雕刻”出所需要的那一朵。    云计算的实质是将计算、应用和服务作为一种公共设施提供给公众，使人们能够随时随地根据自己的需要来使用计算机资源。云计算的一个核心理念就是通过不断提高“云”的处理能力，进而减少用户终端的处理负担，最终使用户终端简化成一个单纯的输入输出设备，并能按需享受“云”的强大计算处理能力。“云”中的资源在使用者看来是可以无限扩展的，并且可以随时获取，按需使用，随时扩展，按使用付费。    1.3 虚拟化和云计算的关系    虚拟化实现了IT 资源的逻辑抽象和统一表示，在大规模数据中心管理和解决方案交付方面发挥着巨大的作用，是支撑云计算伟大构想的最重要的技术基石[6]。云计算的特征体现在虚拟化、分布式和动态可扩展。虚拟化，是云计算最主要的特点，每一个应用部署的环境和物理平台是没有关系的。通过虚拟平台进行管理、扩展、迁移、备份，各种操作都通过虚拟化层次完成；动态可扩展是指通过动态扩展虚拟化的层次，进而达到对以上应用进行扩展的目的；分布式是指计算所使用的物理节点是分布的。    从云计算的最重要的虚拟化特点来看，可以把各种IT资源、软件、硬件、操作系统和存储网络等要素都进行虚拟化，放在云计算平台中统一管理。通过虚拟化形成标准化的虚拟资源池，解决数据中心资源的整合问题，在整合过程中对计算、存储等各种资源进行标准化。虚拟化技术打破了物理结构之间的壁垒，代表着把物理资源转变为逻辑可管理资源的必然趋势。所有的资源都透明地运行在各种物理平台上，资源的管理都将按逻辑方式进行，完全实现资源的自动化分配，而虚拟化技术则是实现这一理想的唯一工具。2 云计算数据中心解决方案    2.1 云计算数据中心的产生    随着信息化建设的发展，以及对数据存储、数据挖掘、高性能计算需求的不断增长，数据中心的规模变得越来越大，传统的数据中心建设模式已经无法满足这种变化。必须有一种高度整合统一、能够灵活扩充、按需分配，并且性能优越的数据中心来满足需求。云计算交付模式以及新一代数据中心建设就是在这种需求中诞生的，其虚拟化技术应用水平不断提高，几乎所有新建和改造的大型数据中心都开始使用或研究虚拟化技术。    新一代数据中心将所有设备和系统资源池化，利用统一计算系统、统一存储系统、统一网络系统，分别构建计算池、存储池、网络池，其整体架构拓扑图，见图1。实现整个数据中心网状结构向虚拟化结构的转变，所有的应用系统、数据、网络数据流全部与硬件系统无关，简化了整个数据中心的逻辑架构，使得数据中心的管理、运维更加简单和高效。所有的应用系统全部处于虚拟化程序的保护之下，在任何设备出现不稳定、故障的情况下，都可以保证应用系统的高效、可用。统一交换和虚拟化是新一代数据中心最关键的两个技术，其虚拟化技术不是将一台服务器变成多台这么简单，它涉及计算虚拟化、存储虚拟化、网络虚拟化等。 图1 数据中心整体架构拓扑图
2.2 云计算数据中心的组成    2.2.1 统一计算系统    将统一计算系统颠覆了传统刀片服务器架构，展现出了一种新颖的观念，将计算能力、联网、存储器和管理都整合到一个由各种厂商的硬件和软件综合而成的平台上。统一计算的作用是，通过突破计算、存储、虚拟化和网络平台间的孤井集成来消除人工集成。虚拟化与统一计算系统共同组成了数据中心的计算节点，利用虚拟化，统一计算系统可以整合工作负载，提高利用率。对于虚拟化部署来说，只有在应用程序运行在一个或多个统一的服务器资源池时，才能最好地发挥自身的作用。传统的服务器和虚拟化部署是分离的，这显然不利于整体资源的应用。而统一计算平台的整体打造则能够将这种问题解决。    思科的统一计算系统采用了10G FCoE 技术，消除了虚拟化部署所担心的I/O 瓶颈问题；并且通过内存扩展技术将服务器的内存扩展到384G，海量内存扩展技术使服务器为虚拟化架构提供更高的性能，搭建数据中心时花费更少的费用；通过虚拟化软件的HA 和Vmotion 功能，能够将负载在虚拟池中进行迁移，彻底消除了正常和非正常的系统停机，确保所有应用系统的高可用性；另外通过SANBoot 技术，将所有虚机放在存储系统中，使刀片服务器真正成为“无状态”计算节点，无状态运算技术使得物理机的迁移成为可能，从而使数据中心的管理更加灵活，虚拟服务器的安全性更高。    2.2.2 统一存储系统    统一存储，实质上是一个可以支持基于文件的网络附加存储以及基于数据块的网络附加存储的网络化的存储架构。这些多协议系统可以通过网络连接口或者光纤通道连接到服务器上。在云计算数据中心部署统一存储系统，可以规划整体存储容量，省去对文件存储容量以及数据块存储容量的单独考虑。用户可以在无需知道应用是否需要数据块或者文件数据访问的情况下，自由分配存储来满足应用环境的需要，提高存储资源池的灵活性。统一存储系统可以满足用户的各种需求，所有的应用程序都可以使用同一套存储系统，并且可以支持所有的存储访问协议，包括此前所有的和未来的主流协议，用户不必担心该存储系统无法支持或者兼容此前的应用系统或者今后的应用系统。    在很多时候，用户在部署服务器虚拟化环境时都会因为性能方面的要求而对基于数据块的裸设备映射提出要求。统一存储为用户如何购买存储虚拟机提供了选择，而无需像之前那样分别购买存储区域网络和网络附件存储设备。高存储控制器配置提升了整套存储系统的性能。并且通过对固态盘的优化，采用固态磁盘虚拟缓存方式，大幅度提升整个存储系统的缓存命中率，尤其是在虚拟化架构下，效果更加明显。以较低的成本，消除了整个数据中心的性能瓶颈。采用自动分层技术，存储系统后台自动调整数据存放位置，优化存储访问方式。    2.2.3 统一网络系统    目前，绝大多数数据中心内部通信网络仍然主要依赖以太网，而光纤通道（FC）网络主要用于存储系统。随着10Gb 以太网的成熟，基于以太网的光纤通信技术（FCoE）和新的无损10Gb 以太网技术开始在数据中心流行，使用统一的以太网整合FC-SAN 存储数据流和普通数据流，该网络融合让数据中心能够保持FC 存储的现有投资，能够把LAN、SAN 和Infiniband 等整合为一个统一的网络架构，从而大幅度降低网络建设的复杂度和成本，并且在技术层面实现更高的带宽、更低的延迟、更好的安全性和可管理性。系统将虚拟机到虚拟机通信所需的交换机精简为一个互联阵列，支持虚拟机间的所有网络流量传输，而无论虚拟机位于何处，都为网络流量提供了单一控制和管理点。因此，无需在刀片服务阵列中部署交换机，而是使用阵列扩展模块，其逻辑上是互联阵列的一部分。将所有流量从刀片服务器传输到上游互联阵列，无需使用软件交换机，虚拟机直接连接到物理网卡，采用直通交换或采用Hypervisor-bypass 技术对其进一步加速。    根据现有服务器的接入需求，并预留合理的端口接入数量（数据中心部署思科新一代Nexus 核心交换机），不但能满足在大规模采用服务器虚拟化后对核心交换机高端口数量、性能、功能的要求，也能通过网络虚拟化最大程度发挥服务器虚拟化的优势，从而进一步保障数据中心安全可靠地运行。思科新一代Nexus 核心交换机能通过虚拟化技术将核心、汇聚、接入的功能融为一体并直接连接服务器，这种架构不但结构简单、管理方便、安全可靠，而且充分节省了空间和布线，为各种应用服务的扩展提供了有力的支撑。    2.3 云计算数据中心实现步骤    实现云计算数据中心分为整合、虚拟化、自动化等3个阶段性步骤。第一步：整合，整合就是将智能网络所需的各种资源实现整合。资源整合的目标是便于被调用，网络成为各种资源整合和调度的公共接口。第二步：虚拟化，虚拟化是将已整合在一体的资源以一种与物理位置和状态无关的方式进行组织，实现自由的跨平台资源调用。通过虚拟化，方便对整合后的资源进行高效调度。第三步：自动化，高度整合和虚拟化基础上的自动化，把虚拟化的资源以一种动态的最优化方式由系统自动根据业务需求来调用；根据用户指定的内容快速分配资源，加速实现应用程序的可用性，实现业务部署的自动化。3 云计算数据中心的发展    在数据中心部署虚拟化可对资源整合管理，提高服务保障水平，降低管理费用；改善资源分配，提高资源利用率；提高设备可用性，增强系统可移植性，降低单点故障；减少电力消耗，节约能源，减少运行成本；减少硬件资金投入和机房空间占用。服务器、存储、网络等资源形成的虚拟架构犹如一台超级计算机，使最终用户从关心单个服务器或存储产品的性能转变为关心虚拟化解决方案的整体性能。    基于虚拟化的云计算数据中心将会呈现以下几个发展趋势：首先是网络的融合与统一交换。随着FCoE 国际标准的逐步普及和实施，在新一代数据中心网络中，存储网络、数据网络、服务器集群网络等多个业务最终都将承载在以太网上，实现网络的融合架构和统一交换，使得数据中心具备更好的性能、更低的成本和更高的安全可靠性。其次，随着IEEE802.3ba 40G/100G 标准的正式发布，100G 将成为大型数据中心网络规模部署的新标准。第三，虚拟化特性将表现得更为明显。通过虚拟化技术，各种资源能够被合理地利用，提高了物理设备的利用效率，同时也增加了各种业务部署的灵活性，最终通过云调度系统来协调各种业务的使用和迁移。最后，低碳节能对新一代数据中心越来越重要，在这方面有突出表现的产品将会格外得到用户的青睐。