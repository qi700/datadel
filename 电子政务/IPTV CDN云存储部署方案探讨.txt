IPTV CDN云存储部署方案探讨
主要研究IPTV内容分发网络(CDN)与存储的关系，阐述了传统IPTV CDN架构的存储特点，提出融合CDN架构和云存储的结合方案。解决CDN存储资源浪费问题。    2011年，中国电信IFrrv用户突破1 200万，其中江苏、浙江、广东、上海、福建五省市用户均突破百万。随着2012年试点城市的全面开花，IPTV业务将会得到更大的发展动力，而如此庞大的用户规模不仅为其后续增长提供了更多的便利条件，也使得IPTV平台自身的架构和服务质量面临考验。     用户规模的增加带动了节目内容的增加，CDN将面临海量存储的挑战。本文从IPTV CDN架构和存储方案进行分析，提出IPTV CDN与云存储相结合的方案，解决现有CDN架构造成的CDN存储成本过高的问题。 1  中国电信IPTV CDN现状     目前中国电信IPTV CDN的容量已达到千万级用户规模，可同时支持高清、标清视频流的分发服务。各省基本上都采用“省中心一区域节点一边缘节点”三层架构，如图1所示。大部分内容采用PUSH方式推到边缘节点，边缘、区域、中心的存储能力根据业务需要按30％-50％、50％-100％、100％合理配置，每级节点均提供流服务，在内容没有命中情况下，采用重定向方式到上一级节点提供服务，从而保证业务体验。   图1 CDN网络部署示意     中国电信现有IPTV CDN存储方案难以满足流媒体业务发展需求，随着高清业务逐步开展，海量存储需求越来越迫切。以广东省IPTV为例，因为存储成本高，在线内容少，从而导致了以下问题：     · 目前的节目和互联网相比，节目总量少，用户不满意。     · 小众节目太少、太分散，难以形成完整的细分化产品体系，难以形成长尾。     · 存储空间太小，节目运营为确保最低限更新率，必须频繁下发和删除节目，已有用户投诉：“节目还没有看完，就下线了”。     · 空间不足导致不能大量引入第三方增值视频，增值业务开展受到制约。     IPTV对CDN存储容量的要求，几乎每年上升一个数量级，而现有的边缘存储模式导致一个内容要在整个CDN中保存多份，随着内容的增加，如果达到PB级别，存储成本无法承受。随着用户规模的增加，节目内容的热度分布不均，为冷门内容提供过多的副本是一种资源浪费。因此，在海量存储和长尾效应的时代，IPTV CDN需要新的存储方案。 2  云存储技术     云存储是云计算概念的延伸和拓展，是指通过集群应用、文件管理技术和网络传输技术等功能，将不同地域不同种类的大量的存储设备集合起来协同工作，共同对外提供数据存储和业务访问功能的一个复杂系统。云存储也可以说是一个基于云计算的平台，因为当云计算系统配置了大量存储设备，有大量的业务数据需要管理和交互的时候，云计算系统实际上就转变成为了以存储业务为核心的云存储系统。     云存储从字面上理解是一个存储的硬件设备，其实云存储与传统的存储设备相比，不仅仅是一个硬件，而是一个复杂的系统，由存储设备、网络设备、应用服务器、应用软件、用户接人控制、软件客户端等多个部分组成。云存储系统的结构模型可分为四层，分别是数据存储层、基础管理层、应用接口层和用户访问层。     (1)数据存储层     数据存储层是云存储最基础的部分，专门用来存储各种各样大量的数据。存储设备可以是多种类型的硬件设备，比如是sun架构的FC光纤通道存储设备，或者是NAS和iSCSI等IP存储设备，又或者是SCSI或SAS等DAS存储设备。云存储中的存储设备一般都是海量的，存储容量到达PB级，且分布多个不同地域，彼此之间通过各种网络连接在一起。     (2)基础管理层     基础管理层是核心部件，是云存储的关键技术所在。基础管理层通过集群应用、文件管理系统和云计算等技术，实现云存储中不同地域不同类型的多个存储设备之间的协同工作，能够虚拟化多个存储设备为统一的存储资源对外提供同一种服务，并且能够根据业务访问量弹性调用存储资源。     (3)应用接口层     应用接口层是用来连接不同的业务应用系统的关键部件，不同的业务应用对应不同的应用服务接口，用户通过相应的接口访问不同的业务应用系统，使用不同业务服务。很多业务需要海量存储，比如视频类业务应用：互联网视频、视频监控等，用户或者企业的数据备份和存储，网络硬盘等。     (4)用户访问层     授权用户可以通过应用接口访问云存储系统，使用云存储的业务数据存储和访问服务，用户可以通过客户端访问也可以通过网页直接访问，用户可以使用的业务应用也是多种多样的。 3  IPTV CDN云存储方案     云存储的特点是存储与服务分离，存储细节对应用层完全透明，存储和服务各自平滑扩容，同时将并发服务的IO能力消耗从流媒体上转移到云存储上。海量空间是云存储的必备特性，可以轻易地提供PB级的存储空间。云存储内的一份内容可以为所有节点服务，并且能够支持异地部署。所以对于CDN来讲，边缘节点只需要部署服务能力即可，存储能力则由云存储提供，降低建设成本提高了存储系统效益。     我们根据现网IPI'v CDN架构和网络条件，提出了两个方案。     · 方案一：全国建一套云存储做为内容库(图2)。   图2 云存储方案一     建设单独的云存储系统，存储全部的内容，各省的CDN节点内仅仅存储热片，用户点播冷片时，由CDN服务节点从云存储内容库获取内容为用户提供服务。这种方案的优点在于原有的系统架构改动小，云存储系统相对独立，可与其他业务共享，降低建设成本。缺点是对网络要求高，对骨干网消耗大，可能会影响用户体验，而且所有的冷片都从一个内容库下拉，对云存储的IO要求非常高。     · 方案二：全网建设多个云存储系统(图3)。   图3 云存储方案二     在全国中心节点部署一套云存储作为全国内容库，全国共享这一套云存储，在骨干边缘的省中心节点各部署一套云存储作为二级缓存，各省CDN共享一套云存储，边缘节点只存储热片。该部署方案的优点在于系统架构改动小，可靠性高，省级云存储作为二级缓存接近服务节点，用户体验较好。缺点在于规模大，对于云存储系统的成熟度要求很高，多节点共享云存储对云存储的IO要求高，需要进一步检验。 4  结语     上述章节提出了几种IPTV CDN云存储的方案，各有利弊。CDN的优势在于在网络边缘终结了流量，减少了骨干带宽，而云存储还需解决带宽穿越的问题；云存储本质是把目前专用的高速存储，转移到以分布式文件系统为基础的低价低速存储设备上，能否满足高速的流媒体并发请求还有待验证。云存储有助于解决CDN面临的问题，但是部署于现网仍存在诸多问题，如网络问题、存储IO问题，这些问题还有待进一步解决。