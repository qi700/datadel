云计算下虚拟机部署机制的研究
本文对当前国内外关于云计算下虚拟机部署的机制展开了广泛的调研，并深入比较了一些提高虚拟机部署效率的方法，同时，研究了虚拟机镜像模板并行传输机制的优化策略。在以上的调研结果下，提出了一种优化方案。采用将虚拟机镜像模板文件分割为若干数据块，分散存储在各个宿主机上，在模板数据块文件从云存储中心加载至宿主机上的过程中，采用优化的并行传输的方法。这样带来两方面的好处：（1）减少虚拟机镜像模板文件的传输时间；（2）本方法将镜像模板文件以分布式方式存储在多个服务器上，缓解了单中心传输的压力。    目前，人们对计算机资源的需求量以爆炸式的速度增长，导致对本地计算机资源的投入成本越来越大。按照传统方法不断购置所需的软硬件资源来满足应用需求的方式，将会给用户带来投入资金再增加、管理人员再培训、开发周期再延长等方面的压力。    随着计算技术的日新月异和人们对计算资源需求的不断增长，为解决上述问题，云计算技术应用而生。云计算是基于互联网的新兴商业计算模型，它可以使数据中心的计算能力在互联网上自由流通。“云”是大量具有自治功能的计算资源，通常是一些大型服务器集群，包括计算服务器、宽带资源、存储服务器等。云计算把管理一个计算中心的费用和维护硬件的费用转换到第三方。公司或者个人根据其业务负载快速申请或释放资源，只需要支付实际资源的使用费用就可以在世界范围内部署所需服务。    虚拟化是指把底层的硬件设备与上层的软件服务分离的一种去耦合技术，可以实现计算机资源的高效灵活使用。虚拟化技术的目标是整合或划分物理计算资源。所以虚拟化技术是云计算的重要组成部分。随着云计算的发展，虚拟化技术重新进入人们的视野并受到越来越多的关注。    当前，云计算平台下待处理的数据量以爆炸的方式增加，用户服务需求量增多对云计算云台虚拟化资源分派、调度策略以及管理实施方法，提出了更高的要求。目前，国内外云计算平台虚拟化技术的优化已成为学术界和企业界研究的热点。1 国内外相关研究    虚拟化技术在云计算中起着至关重要的作用，使得云环境下虚拟机部署成为人们研究的热点。这些研究主要集中在以下几个方面：虚拟机内部监控、虚拟机的迁移技术、虚拟机快速部署m3等。虚拟化资源管理：旨在为用户提供可靠的服务，为达到这一要求，必须保证虚拟机的正常运行．借助虚拟机迁移技术可以实现虚拟机和物理资源的重映射，借助运行在物理硬件和操作系统之间的虚拟机监控器。可以把虚拟机的整个运行环境从一台物理机上迁移到另外一台物理机上面。    目前，在云计算的诸多研究中，虚拟机快速部署机制是一个研究热点。在传统的虚拟机部署策略下，当面对大量用户的服务请求时，往往需要一定的等待时间。这大大降低了人们对“云”的期待。因此，本文将着重从这个角度研究。2 云环境下虚拟机部署体系    云环境下虚拟机部署系统的体系结构(如图1所示)可分为4层：用户接口层、核心管理层、虚拟化层、物理资源层。各层功能如下： 图1 云计算虚拟机部署的体系结构    ①用户接口层：该层通过Web页面方式或者客户端界面为用户提供功能接口，包括模板信息显示、虚拟机信息显示和服务申请入口。    ②核心管理层；是云计算下实现虚拟机部署功能的主体部分，是云环境下虚拟机部署系统的核心部分。该层功能的实现主要依靠以下功能模块：    a．镜像模板库管理：主要负责管理云平台所提供的虚拟机镜像模板和用户自己的虚拟机镜像模板；    b．镜像调度模块：将用户选择的虚拟机镜像模板，从模板库中加载至宿主机；    c．虚拟机实例化模块：通过该模块将虚拟机镜像模板文件实例化；    d．虚拟机状态监控模块：监控宿主机上虚拟机运行的状态，主要有CPU利用率、内存利用率、网络配置状态等信息；    e．资源动态调整模块：可对已经分配给用户的资源进行调整，这样可在满足用户需求的同时，保证服务器的负载均衡；    f．负载均衡模块：选择下一个计算资源节点，并且将新的服务请求转发给它。    ③虚拟化层；该层将离散的硬件资源统一为可以创建动态共享的平台。    ④物理资源层：该层的硬件由服务器、存储设备、网络设备等硬件资源组成。
3 云环境下虚拟机部署流程    云环境下虚拟机部署流程图(如图2所示)。 图2 虚拟机部署流程    部署流程如下：    ①用户通过Web页面或者客户端界面选择需要的虚拟机类型和模板类型，发送至用户接口层；②用户接口层将用户的服务需求信息打包，传送至核心管理层；    ③核心管理层根据用户的需求，结合当前云平台下虚拟机状态信息和负载情况，确定虚拟化任务，并将命令发送至虚拟化层；    ④虚拟化层在物理资源层选择合适的服务器作为宿主机；    ⑤从虚拟机镜像模板库加载镜像模板至宿主机并实例化生成虚拟机。4 关于虚拟机快速部署机制的研究    云计算下虚拟机快速部署机制的研究多是在部署流程各环节进行的一些改进，目前主要方法是对虚拟机镜像模板文件传输机制的优化。    虚拟机镜像模板就是虚拟机的主虚拟硬盘，包括了虚拟机上的操作系统和其他用户需求的软件。一个完整的镜像文件会占用大量的磁盘空间，如一些用于科学计算的专业应用的镜像模板会有十几G，甚至几十G。所以，虚拟机镜像模板文件的传输占用了整个虚拟机快速部署的大量时间。对于虚拟机镜像模板库以及虚拟机镜像模板文件传输机制的研究，可以优化虚拟机部署效率。    文献[4]用文件压缩机制对虚拟机镜像模板文件的体积优化。在模板文件传输前进行压缩，传输到宿主机后，再解压缩，通过这种方式减少了网络传输量。文献[5]应用模板预拷贝策略来减少模板文件传输时间。该方法是通过对用户感兴趣、部署频率高的模板预先存储在一个预拷贝模板库中以供下次拷贝使用。在这里预拷贝模板库采用与传统模板库不同的存储方法。文献[7]中描述了通过虚拟机镜像模板的增量备份来实现虚拟机快速部署。
5 基于分布式模板文件传输的虚拟机快速部署机制    传统方法中模板文件传输是从一个中央存储中心向多个宿主机分发一个超大文件。这种方式下，在大量服务申请下。中央存储中心的传输能力便成为整个系统的瓶颈。    本文将虚拟机镜像模板文件以分布式的方式存储在多个模板文件存储中心。当大量用户提交服务请求时，分别从不同的存储中心下载虚拟机镜像模板文件。6 实验分析    实验环境由4台服务器和3台存储组成。其中1台服务器作为核心管理平台，3台服务器作为云计算物理资源池，3台存储上各建立一个虚拟机镜像模板库。在实验中采用windows Server 2003的镜像模板文件为实验数据源，并将该模板文件分别存储在3台存储上。    实验1：当3个服务器从1台存储上同时下载模板文件；实验2：当3台服务器从3台存储上同时下载模板文件；    实验1和实验2的结果对比如图3所示。
图3 实验对比图    图3中横轴代表下载模板的台数，纵轴代表每个模板下载的时间，结果显示，在本文方法中，模板下载时间要小于传统方法。7 结束语    对云计算下虚拟机部署模型和相关快速部署策略进行了研究，并对镜像模板文件采用了分布式存储的方法来提高虚拟机部署效率。未来工作将把该方法应用在整个虚拟机部署系统中，并在更大规模的虚拟机部署下验证有效性。