多协议标签交换技术在全光互联网中的应用
本文首先介绍了MPLS向光网络的扩展，其次阐述了传统电域交换技术在光域中的应用，最后分析了基于标签交换的全光互联网解决方案：多协议波长标签交换MPLmS、基于标签光突发交换LOBS、全光标签分组交换OLPS.1、MPLS向光网络的扩展    传统的ip网络是“尽力而为”的，在流量和网络带宽管理上功能很弱，往往导致网络发生拥塞，很难满足对时延、抖动和传输质量有特别要求的应用（如语音和视频业务等），此时MPLS（多协议标签交换）应运而生，实现了将第三层的包交换转换成第二层基于标签的包交换的“多层交换技术”，可使用各种第二层的协议，如帧中继、ATM、PPP、以太网等。MPLS具有基于标签的快速转发和很强的流量工程管理功能，能够提供较好的QoS方面的服务保障，IP/MPLS over ATM这种成熟的技术结合方式已经被广泛的应用到能满足电信级QOS要求的骨干网络中。    随着光通信技术的发展，通信距离已经“死亡”，网络传输带宽瓶颈已经成为过去，WDM技术在光纤中的应用给出了IP/MPLS over ATM模式的一种替代方案，即IP/MPLS over WDM，高速的ATM交换路由器从骨干网走到了网络的边缘。为了将MPLS应用到光网络上，必须将MPLS的路由协议和信令协议与光交换机相适配构造智能型波长路由器/光交换机，同时将对传统MPLS协议作相应的扩展和修改。与此同时IETF提出了GMPLS的全新概念，它是MPLS向光网络扩展的必然产物，具有对智能光网络进行快速实施光连接，在光层实现动态业务分配和动态的提供网络资源，以及实现网络端到端监控保护和恢复功能。GMPLS能支持多种交换类型，如分组交换PSC，时分复用TDM﹑波长交换LSC和光纤交换FSC，由此出现了通用标签和LSP分级嵌套概念，即允许系统以一个转发层来进行缩放，那么位于顶层的标签将是FSC接口，接下来的是LSC、TDM，最后是PSC.GMPLS还扩展了MPLS在逻辑上把控制平面从数据平面中分离出来的概念，允许与数据平面相关的多种物理上的控制平面存在。     2、传统电域交换技术在光域中的应用    在传统的话音和数据业务网中我们已经分别采用了电路交换和分组交换这些成熟的技术，相比之下突发交换技术就鲜为人知了，当然从交换粒度，交换模式（直通还是存储转发），网络带宽资源的预留方式等方面来分类的话还有许多交换技术，应用最多的就是以上三种交换技术。根据它们的各自特点，在光域中出现了相应的三种光交换技术：    1）波长路由交换（WRS）：在WDM网络中使用电路交换技术时，是以波长交换的形式来实现，在相邻节点间的每条链路上，一个波长就对应一个用于交换的光通道，提供端到端的“虚波长路由”，在网络的边缘建立起光路径。光路径通过沿路径的每条链路上预留专门的波长通道而创建。在点到点的光通路中传输数据流时，中间节点不需要任何处理，不需要任何E/O和O/E转换，也不需要缓冲数据。波长路由交换网络就是传统电路交换网络的一种形式，不能统计复用共享带宽资源，所以带宽利用率比较低；    2）光分组交换（OPS）：电域的包/分组交换在光域上表现为光分组交换OPS，是基于虚电路和光时分复用方式的，采用固定长度短数据包格式，一般基于TDM来使用光纤中的所有带宽，数据净荷以光信号方式存在，信头开销可以是光形式，也可以是电形式，通过带外波长或副载波复用传送控制开销使之与业务数据分开，控制开销和业务数据之间的时延用光纤迟延线（光存储器）来实现，而可变长度的光分组，可使用串联的光纤延迟线来实现，OPS主要优点是能通过统计复用网络带宽资源提高带宽利用率，而由于通过光/电转换处理控制信息带来的时延问题比较严重；    3）光突发交换（OBS）：结合了波长路由交换和光分组交换的优点，OBS技术通过在有限的时间段预留带宽来提高网络利用率。基本交换实体就是突发帧，它是在入口节点、中间节点、出口节点之间移动的一串数据包。突发帧主要由头部控制突发帧（Control Burst）和数据突发帧（Data Burst）组成，它们之间各自独立传送。控制突发帧被先于数据突发帧传送用来沿路径预留带宽，接着数据突发帧随着控制突发帧预留带宽的相同路径传送，同时有三种突发交换协议TAG（Tell-And-Go）、IBT（In-Band-Terminator）、RFD（Reserve-a-Fixed-Duration）来协调控制突发帧和数据突发帧之间的协同工作（即它们之间的发送偏置时间）；3、基于标签交换的全光互联网解决方案    将传统的MPLS技术和波长路由交换，光分组交换，光突发交换相结合形成了基于标签交换的全光互联网技术，相应的全光互联网解决方案有：多协议波长标签交换MPLmS、基于标签光突发交换LOBS、全光标签分组交换OLPS.    3.1多协议波长标签交换（MPLmS）光互联网技术    MPLmS是传统电MPLS在光域上的扩展，使用OXC作为LSR，波长作为标签（如图1所示），沿用了原有的MPLS框架，不需要定义新的内容。它直接采用第一层（光波长级）的交换来处理第三层的IP路由转发，将标签与WDM波长信道关联起来，其分立波长或光纤信道类似于标签，并通过MPLmS信令来指配光信道。从而大大简化了网络的层次结构，并具有更强大的业务管理、流量工程、QoS保证的功能。MPLmS也可以看作是一种没有标签栈或按包转发的简化MPLS，利用IP选路协议来发现拓扑，利用MPLS信令协议来实现波长通路的自动指配，为实时配置光波长通路提供了基本框架，选路与信令分离有利于灵活引入新特性新算法。这种方法可以使业务层上的路由器、ATM交换机或ADM动态地要求传送网提供所需的波长，实现统一的网络控制和快速业务供给，简化了IP层与光层的融合以及跨层的网络管理，降低了网络运行和业务拓展成本，有利于大规模网络敷设。IP层与光层的融合正展现了前所未有的前景。MPLmS是构建新型网络的管理控制平台，通过它可将IP等各种业务无缝的接入到具有巨大带宽的光纤网络上来，是构建未来新型网络的有效方法。
图1 MPLmS网络体系结构及标签交换过程
MPLmS把MPLS标签交换的基本概念应用到了光域，采用光波长作为交换的标签，将第三层路由转发与第一层(光层)的光交换进行了无缝融合，利用波长来寻找路由，并标识所建立的光通路，为上层业务提供快速的波长交换通道。光网络节点被看作是MPLS设备，MPLmS光网络的边缘采用标签栈，它将更小的电MPLS设备节点的LSP整合进更大的波长LSP中。MPLmS域的中间节点在数据传输过程中不再运行任何电的标签处理，并且只有有限个标签处理操作在光域上实现。利用这些功能，波长标签方案将MPLS的控制平面粘贴到光波长路由交换机/光交叉连接设备的上层，并将它看作是具有MPLS能力的节点，即光波长交换路由器(O-LSR)节点。
实际上最初MPLS的标签交换的目的是运行第二层的快速转发来处理第三层的数据流，人们延伸了这种想法，波长标签在本质上是运行第一层（如光层）转发来处理第三层的数据流。尤其是在MPLmS标签和WDM波长通道之间，允许使用MPLmS信令来建立光路径通道。例如，一个在对等MPLS O-LSR之间的端到端的光路径等价于一个粗粒度的LSP，称为波长LSP等。下面我们看看MPLmS的网络模型：MPLmS应用的网络模型图2所示。支持标签交换的IP路由器（LSR）连接光核心网络，光网络由若干OXC通过光链路相互连接而成。OXC由光层面的交叉连接设备和控制平面组成，具有数据流交换功能，交换由可配置的交叉连接表控制。目前，OXC节点交换需要进行光电转换，在电域进行。随着光开关和可调谐激光器等技术的进步，将来它可以实现全光交换。控制平面使用基于IP的协议和信令进行节点的可达性检测、控制建立和维护端到端的光通路。
图2 MPLmS的网络模型
在MPLmS中，波长标签可以由上游节点提出，由下游节点认可后使用，用于在某些特定的光网络设备区域中建立LSP.传统意义的LSP是单向的，为了适应光网络的需要，MPLmS支持双向的LSP，以简化倒换过程、减少建立LSP的延时和维护开销。该标签请求支持建立LSP需要的通信参数，包括链路保护、链路编码、LSP净荷等。通过标签请求可提出链路保护类型要求（1+1或1：N）。链路的保护能力通过路由协议发布，以供路由选择时使用。标签请求消息还携带LSP链路编码参数，称为LSP编码类型（SDH/SONET/Gage）。图3是标签请求（通用标签请求）TLV（类型/长度/值）结构（以CR-LDP为例）。
LPT：链路保护类型，8比特，0表示没有链路保护要求。LSP-ENC：LSP编码类型，16比特，定义了OC-n（SONET）、STS-n（SDH）、GigE、10GigE、DS1～DS4、E1～E4、J3、J4、VT以及光波长、波带等类型。G-PID：通用净荷标识，表示LSP运载的净荷类型，使用标准的以太网净荷类型，由入节点设置，供出节点使用，中间节点仅进行透明传送。
为了支持光网络的传输环境，MPLmS标签应该支持对光纤、波带、波长甚至时隙的标识。不同的应用环境下标签格式不同，以CR-LDP为例的TLV格式图4所示。
图4以CR-LDP为例的TLV格式
链路标识符标识收到标签请求的链路，仅在邻接的节点间具有本地效力。标签的长度和格式根据不同的应用环境而不同。比如在波长标签交换应用中，端口/波长标签为32比特，表示使用的光纤或端口或波长，与传统标签不同的是没有实验比特、标签栈底标签和TTL等域，但它与传统标签一样，仅在邻接节点间具有本地效力。标签值可以通过人工指配或由协议动态决定。MPLmS概念的提出是MPLS技术发展的重要里程碑。通过光波分复用以及波长交换技术不仅提高了光传输网的容量，而且可以很好地利用标签交换及其相关协议的应用经验，以MPLS技术提高光网络的灵活性、生存能力并实现流量工程。3.2基于全光标签分组交换（OLPS）的光互联网技术    所谓全光标签分组交换技术就是在光分组信息上利用光技术附加可有效改变光分组交换性能的光标签技术。目前关于光标签头和光分组的复用技术主要是利用副载波复用SCM技术实现。如图5所示它将副载波复用光头粘在每个分组上，即标签头采用与分组净荷传输所用的波长相同的波长的带内方式，但是为了有效利用带宽，使用带外调制来转发分组数据。这种方法中数据头和净荷信息被复用在同一个波长上，但数据是调制在基带上，而包头信息承载于一个合适的副载波上。这样克服了传统分组交换需要承受的光缓存（消除了迟延线的使用）和比特同步的限制。
图5光标签的随路和共路复用方式-副载波复用SCM
OLPS光标签分组交换技术将目前普遍接纳的IP寻址、标签交换与光波长交换技术有机结合起来。采用标签交换技术，可发挥其支持组播（Multicast）、合并（Merge）和约束选路（constraint-based routing）等特点。通过优化设计分组交换字节结构避免了同期到达的去往同一目的地的数据包对资源的竞争问题，改善了端对端的时延特性，简化了路由器入口处处理包头信息和转发等价类（FEC）分配的过程，改善了选路的性能和成本，从而实现了快速有效地分组转发。
OLPS网由光标签边缘路由交换机OLER和光标签核心路由交换机OLSR组成。在MPLS原理中我们提到，的三层地址（IP）地址被映射成第二层地址（即就是标签，当在OLPS网络中时时光虚道路标识OVPI）。这种对等的多层映射（MLM）方法将第三层的路由和第二层的交换有机的结合在一起。路由信息被第三层IP选路协议分发到相邻路由交换机，以便使分组转发只按照第二层信息来执行。按照激发本地映射的方式的不同，可将MLM分为流驱动和控制驱动两种：           1）流驱动MLM遵循“次选路，全部交换”的方针。只分析数据流中开始的一些数据包，将持续期长的数据流映射到本地直通连接上，而将持续期短的数据流一个包一个包地进行逐包处理。基于这种方法的著名的方案就是Toshiba的“元交换路由”方案和由Ipsilon开发的“P Switch”方案；    2）控制驱动MLM是由路由更新激发地址映射。控制驱动意味着每一次映射要么是诸如IP包的路由信息报文驱动的，要么就是由路由器或IP RSVP包控制报文来驱动的。相关的一些公司如Cisco（Tag Switching）、Asend（IP Navigator）和IBM（ARIS）均开发了此类技术以满足骨干网络的要求。在网络设计中必须遵循现在已经被工人是未来发展方向的一种优选网络设计原则，即“高网络边缘的智能化，以换取骨干网络性
全光标签分组交换网络中的核心光标签路由器OLSR即可以使用空分交换也可以使用波分交换，并且仅对带有路由信息的光分组头进行高速处理而为光分组的有效负载提供透明路径，因此他具有高速、大吞吐量、低延时、业务和比特率透明等突出特点，嫩高效的承载IP业务，同时它还能灵活地组网和实现网络升级，大幅度提高网络适应性和生存能力。光核心路由器主要有光分组头识别和重置、冲突解决、分组路由和传输控制等光信号处理功能模块组成。同时，目前基于光标签交换的分组光网络研究在网络管理和控制方面，充分吸收了IETF（Internet Engineer Task Force）开发地MPLS技术的一些技术优势。    全光分组交换节点OLSR主要有标签交换模块和光子交换机组成。光标签交换模块负责：检测分组字头；完整的转发数据包；检测包的端点；当需要的时候重写光子头；而目前可是用的比较先进的光子交换技术有：微电子机械技术MEM、LiNbO交换器、快速液晶交换器、半导体光放大器SOA或电吸收EA调制器/交换器等。    光标签边缘路由器OLER主要负责为IP包分配光标签和为每一个分组选定一路波长；而核心光标签路由IOLSR要执行标签处理、新标签的计算、全光的刷新标签和转换分组所在的波长。    光标签分组交换网的核心网络接点主要是按照OVPI标识来对IP包（第二层）执行转发交换操作。每一个OVPI主要包括节点号、端口号和波长编号，它是由入口OLER负责分配，在交换过程中他的具体数值会在每一个下游交换节点上被更新。这时就相当于由IP选路和OLPS交换机电互联而构成了具有光标签分组交还能力的IP路由交换机。换言之，OLPS网络的节点不但具有其他路由器所具有的路由表和路由更新协议，而且具有按照标签进行光交换的能力，因此可以说他所执行的功能就是IP交换路由器的功能，但这时路由表的更新与传统路由器中的地址信息更新不同，而是对OLPS节点中光虚通道表进行更新。路由更新信息是通过在OPLS分组头中标定一个特定的域来传输适当地选路协议而从相邻节点获得的。OPLS节点的基本功能，一是通过选路IP包来更新路由表以获得对光包执行转发操作所需要使用的IVPI标识；二是对第三层选路由结果执行标签绑定操作；三是依据标签对光分组进行转发。贴有标签的分组能够被下游OLSR节点探测出，并由节点选路控制器来管理它的去留。    当OLPS节点面对不平衡业务状况时，可通过给网络中边缘路由器OLER之间的任一光的虚通道分配峰值带宽方法，来合理管理OLPS网络资源以便校正业务的不平衡问题。这种网络资源方法虽然降低了OPLS网络资源的利用率，但是在网络带宽大到无穷而带宽成本不成为问题的时候，这种低的带宽利用率的资源管理方法仍可以接受。而且这种基于MPLS的OLPS网络还可提供对具有不同Qos要求的业务进行管理的能力。当网络存在延时抖动和包丢失时，可为“供质量保证”的业务预留一定量的带宽，同时将剩余带宽提供给“尽力而为的”业务。在这种情况下，特别是对于提供质量保证的业务就需要呼叫接入控制机制，而这些控制机制不应占用可用带宽。在OLPS网络的边缘路由器OLER上，可对需要执行业务分级的业务，使用诸如WFQ（Weighted Fair Queuing）方法或不同的包丢弃算法，同时对提供质量保证的业务使用“漏斗”算法来分配所需带宽。    目前光标签分组交换技术要步入实用还受制于逻辑处理技术相对滞后而造成的光标签头的高速超快、全光刷新、重写以及光头可用带宽太窄等技术的限制。因此真正意义的光分组交换网络要获得实现还需要有相当长的时间。    3.3基于标签光突发交换（LOBS）的光互联网技术    由于光突发交换与（波长）电路交换和光分组交换相比具有特有的优势，同时MPLS的标签交换技术对未来网络组网技术的影响也意义深远，所以我们同样可以将MPLS的标签交换思想引入到光突发交换中来，从而产生了基于标签的光突发交换技术LOBS，为IP Over WDM光互联网开辟了一种新的解决方案。    使用OBS来支持IP Over WDM的一个方法是在每个WDM光交换上运行IP软件和协议，以及其它的控制软件（当然现在考虑的IP协议主要是MPLS协议和其控制技术），这些控制软件是网络层与WDM光层接口的一部分。在WDM层使用专用的控制来为这些IP实现间提供静态的/物理的连接，特别的这些专用的控制波长可用来交换那些在物理上相邻的、包含拓扑信息和路由表的IP实体间的分组信息。为了发送数据，首先需要用一个控制分组在不需要经历中间IP实体的情况下发送到宿端，这样就减少了突发分组的等待时间以及在IP层上的处理。需要注意的是，由于控制分组的有限的不透明性，OBS能达到对阻塞和故障的高度的适应性，并且像在光分组/信元交换中一样，能支持基于优先级的路由。    基于标签的光突发交换LOBS技术与前面所述的MPLmS技术在吸收MPLS标签交换技术方面的基本思路是一致的，所不同的主要是LOBS将控制信道和数据交换信道进行了分离，标签信息在控制包中：而且这时在波长信道上所承载的数据是由多个IP包组成的突发数据流。在LOBS网络中，每一个控制包/分组由控制信息和标签构成，并作为一个普通的IP包在运行了LDP而预先建立起来的一个LOBS通路上被传送，该通道就类似于标签交换通路LSP.在入口LOBS节点将多个IP包组装成突发数据流，然后该突发数据流就在由节点对控制包中的标签进行处理后相应建立起来的波长通道上传输。在数据流的整个转发过程中，都无需进行任何电子操作而完全在光域上执行，其它的标签操作均类似于MPLmS实现方案。在MPLmS中，每一个波长为一个标签，即就是标签交换通道LSP是波长通道。这时由于缺乏波长合并（merging）技术，所以中间节点无法在光域上实现对多个LSP的整合操作，因此不能实现业务合并和疏导（grooming）。相反在LOBS中每一个突发数据流对应一个标签，在每一个交换节点上都对标签信息、波长号、偏置时间等控制信息执行电处理操作，因此不同LSP通路上的突发数据流无需进行光/电/光变换就完全可以进行业务整合。    此外，在骨干光网络中应用OBS技术实现Qos有好几种方法：    首先，我们可以控制LSP的建立，使其只具有一个较小的突发阻塞概率，方法是通过OBS MAC层的统计整型特性和在LSP整形结构的执行过程。突发数据包在一个LSP上的到达统计特性即使经过几个节点以后也不会改变，这是因为整个交换过程对数据包都没有执行缓存操作的结果。因此，在确认一个LSP建立以后，在其输出接口，我们就完全可以预期它是否保持一个较低的突发阻塞概率。    此外，通过优化设计和规划OBS MAC层结构，我们可以实现预期的LSP时延特性。因此，LSP对IP层来说就是一个可以信赖的、具有某种被指配的数据速率的数据传送管道，而且具有较低的突发阻塞概率和确定的传输时延。因此，在IP层可以应用标准的IP Qos机制例如区分服务DiffServ（differentiated service）对业务进行区分。
4、结束语
下一代网络NGN是一个以软交换为中心，以智能的OTN为基础的传送光网络。目前ITU-T提出的ASON具有大容量光交换能力和网络拓扑结构自动发现、端到端光电路配置、带宽动态分配等功能，是一种新的全光互联网解决方案，具有很大的应用前景。