电子签名技术在PDM系统中的应用
以Teamcenter的二次开发技术和VBA技术为基础，通过对基于Teamcenter平台的PDM系统的研究，在企业工作流程中添加电子签名处理程序，再通Teamcenter的开发接口将程序注入到系统中，实现了Teamcenter的电子签名功能。通过在企业中实际应用，PDM系统增强了企业PDM系统中文档的安全性，使PDM系统在流程管理方面变得更实用，也简化了对文档的处理过程。l 引言    PDM技术的诞生不仅解决了企业中与产品相关的数模图纸的组织与管理问题，实现了电子化的工作流程管理，提高了企业的工作效率与竞争力。随着PDM技术的广泛普及与使用，威胁数据安全的活动也日益增多，如何保证及加强数据安全性与可靠性，特别是保证重要信息的完整性，已成为刻不容缓的问题。而在众多安全技术中，应用于电子文档的电子签名技术在保证信息安全方面有着很好的效用，将电子签名应用到PDM系统则可以大大加强系统的信息安全。2 关键技术理论    2.1 Teamcenter及其工作流程模块    Teamcenter的基本功能包括文档管理、权限管理、产品结构管理和工作流程管理等，支持自顶向下的产品设计方式和多种灵活可靠的产品结构配置规则。同时，Teamcenter提供强大的二次开发接口，在实施PDM项目时，可以通过程序接口对产品进行订制和开发。    Teamcenter系统中，工作流模块用于设计与定制符合企业要求的流程模板供企业使用。流程模板由各个任务模板按照一定顺序组成。任务模板包括执行模板、审核模板、分支模板等。在Teamcenter中大部分对流程进行的限制和操作都是通过Handler程序来完成的，用于扩展和定制符合企业实际生产过程环节的任务。通过定制的工作流程，企业可以完成设计数据审批、电子文档归档、工程更改等业务过程。    2.2 集成工具包技术    Teamcenter的二次开发分为客户端和服务器端。客户端用Java语言开发，同样它的二次开发也使用Java语言；服务器端的二次开发利用集成工具包(Integration Toolkit，ITK)及c语言。Teamcenter的功能模块是建立在集成开发工具包之上的应用模块。ITK中的User Exit工具不仅提供了对Teamcenter的核心部分进行定制的功能，还能让用户开发其他的处理函数扩展Teamcenter的功能。通过Teamcenter的User Exit工具能够实现的功能如下所述：    (1)对Teamcenter系统提供的函数进行修改。    (2)增加处理企业工程更改报告和企业流程模板中的Handler。    (3)为Teamcenter增加新的功能函数。3 电子签名技术的设计与实现    3.1 实现原理    本设计提出了利用ITK技术结合VBA技术的解决方案，即利用ITK技术加入流程中的Handler来提取流程中的审核信息，再利用VBA技术对电子文档的签字。Handler本身并不完成数据集的自动签字功能，自动签字是由服务器端的VBA程序完成的。将此Handler与VBA程序的实现的功能分开，也给程序带来了很大的扩展性。按目前的结构，如果需要增加对数据集的签字功能，只需要编写相对应的VBA程序，并在流程归档结点调用系统自带Handler时设置参数即可；如果要实现对电子文档、工程图纸的签字功能，则需要重新编写Handler，不利于系统的扩展和维护。该方案中通过编写Handler获取流程审核者的名字等信息，传递给VB脚本，再通过VB脚本的后台代码对电子文档进行签字，这样保证了在流程中其他人员对文档没有修改权限，从而保证了签名的有效性。    签字功能中可以使用TEXT和IMAGE两种方式进行签名。TEXT则在文档中签署的是审核者的名字，用IMAGE方式则是利用审核者的签名的图片来代替名字。    3.2 实现过程    下面以一个通用的企业产品设计审批流程为例，说明电子签名技术的实现原理，如图l所示。
图1 设计审批流程示例    电子文件一旦进入流程，则在流程的各阶段(编制、校对、审核、批准)均设定为只读，这就保证了文件在流程中不会被任意修改，保证了其在流程中的安全，只有在最终归档阶段才开放电子文件的修改权限。归档是一个自动完成的过程，该阶段不设任何审批人员，不需要人工干预，从而最大限度地保证了文件的安全。归档阶段Teamcenter系统除完成必要的功能之外。需要实现电子签名过程，实现自动签字的流程如图2所示，实现步骤为：
图2 电子签字过程图    (1)Teamcenter系统在流程进入到完成阶段时触发Handler。检查是否有需要签字的数据集，即检查目标附件中是否有Excel或Word的数据集。    (2)获得签名图片的图库。图库保存在Teamcenter系统管理员Home目录下的IMAGE文件夹下，找到所需的签名图片后，将图片导出到临时文件夹。并获取到数据集的源文件，将文件导出到临时文件夹用于签字。    (3)通过代码获得流程信息，并将流程信息储存到相应的参数中。获取流程的参数设置，获得使用的签名方式为IMAGE或TEXT。枚举流程中的所有数据集，逐个判断其数据集类型，分别调用相应的WSF文件完成自动签字。    (4)对应的VBA程序从传递的参数中读取流程信息。VBA程序自动将流程中审批者的信息填写到数据集中的指定位置。    (5)由完成数据集的保存工作，添加数据集的命名的引用，将签完字的文档保存到Teamcenter中,流程结束。
4 PDM系统配置过程    4.1 签字图片配置    在Teamcenter系统管理员的Home目录下新建IMAGE目录，再在IMAGE下新建sign目录，在sign目录下新建IMAGE类型的数据集，数据集名称是对应用户的lD，图片为相对应用户的签字图片，结果如图3所示。
图3  签字图片配置    4.2 签字流程配置    新建的需要签字的工作流，签字的Handler(cust-signoff-info)添加在该工作流的“完成”部分。正确配置参数-document，-template_type，-template，-sign_type。添加完成的Handler如图4所示。
图4  签字流程    4.3 文档签宇位置的名称定义    需要在文档中定位电子签名的存放位置，以Word2007为例，依次点击菜单“Office”一>“准备”一>“属性”按钮，选择文档属性下拉菜单中的“高级属性”，选择“自定义”，输入名称和取值，其中类型默认为文本，然后点击“添加”按钮。重复该步骤可以添加多个自定义属性。其中自定义名称的名字为流程中需要签名的任务的名称，代码中通过该名称找到需要签字的位置，对应的名称中签署对应的审核者名字。在签名时，签署的名字会覆盖其原有的值，名称的值类型为文本类型。选中文档中需要签字的位置，进行自定义名称的添加。依次点击“插入”按钮，选择“文档部件”，选择“域”，类型选择“文档信息”，域名选择“DocProperty”，属性选择对应的属性。点击确定即可完成添加，保存结果。其中属性即为上一步所定义的属性名称。5 企业实际应用    根据企业加强文档和图纸安全性和有效性的需求，首先开发了相关的Handler以及VBA程序，实现了对文档的自动签字功能，并把该添加在企业流程的相应位置，可以实现自动签字的功能，增强了企业中文档的安全性和有效性。目前这些功能在企业运行情况良好，达到了既定目标。    在企业PDM系统中，所有的文档都是以电子形式存在的，为了提高文档的安全性，在流程中是不能对文档进行修改的。所以，审核者也无法对文档进行签字。若是走完流程后，再进行逐一的签字，实际工作会繁琐耗时，通过开发数据签名功能，在流程结束后，自动添加各个结点的审核人员，既提高了工作效率，也保证了文档信息的安全性与完整性。    下面以零件的签署报告为例，说明电子签名的应用过程，应用的流程为企业中零件审批标准流程。如图5所示。
图5 零件审批标准流程    流程下的审核流程在校对、审核批准阶段需要有相关的审批人员进行审批工作。在审批完成后，需要在签署报告上的相应位置签上审核者的名字，实现功能如图6所示。
图6 工程签署报告6 结语    通过对PDM系统配置功能的研究和服务器端的二次开发，再结合VBA等计算机技术，能够实现电子签名在PDM系统中的使用，并适应不同企业的实际情况，达到方便企业用户使用PDM系统和保护电子信息安全的目的，在满足企业的个性化需求的同时，能够极大地提高企业的效率。