桌面虚拟化在集中监控中心的应用
桌面虚拟化技术在集中监控中心使用可以大大降低TCO(整体成本)，并提高运营效率。首先通过服务器整合，控制和减少物理服务器的数量，明显提高每个物理服务器及其CPU的资源利用率，从而降低硬件成本。
桌面虚拟化技术是服务器虚拟化技术的延伸应用。服务器虚拟化，即操作系统、应用程序及与服务器工作负荷有关的I/O封装在一个名为虚拟机的文件中，让多个虚拟机在一台服务器上运行。因此，可以将桌面系统映像存放在数据中心的服务器统一部署和管理。采用桌面虚拟化技术可以解决集中监控中心的环境、组网及效率问题。从集中监控中心的情况入手，全面探讨了桌面虚拟化技术在监控中心的应用、组网方案和应用效果，希望通过新技术提高监控中心工作效率，解决目前集中监控中心存在的终端使用、管理等各种问题。
电信运营模式的转变将电信企业推到了新的发展阶段，即通过体制、管理、技术、业务等全方位的创新来实现企业的增长。2002年开始，中国移动推行集中维护体制至今已走过了近10年的历程，全网设备的监控集中管理是其中最有成效的一项工作。集中监控实施后，劳动效率翻了几番，专业水平明显提升。但面对日益增加、越来越多的网管监控桌面设备数量，如何降低管理成本、提高管理效率、减小管理难度，是一个非常突出的现实问题。
1、集中监控中心引入桌面虚拟化技术的问题
以内蒙古移动监控中心为例，目前监控大厅内部署着100台以上的PC机，每台PC机都运行一个、两个或多个网管软件客户端程序，同时支撑所有网管系统的监控需求。网管中心集中监控室的主要工作是面向全区所有的网络设备，利用网管系统实施7×24小时全网设备的一点值班、集中监控。与传统的监控中心相同，内蒙移动的监控大厅也全部采用PC机作为工作平台，告警记录、工作流程处理都是通过PC机及网管客户端软件完成。但PC机自身并不是为了7×24小时运行而设计的，在监控这种要求7×24小时运行的环境中，设备频繁更新。随着网管应用软件对硬件系统的要求越来越高，PC机的配置逐步提高，相应的投人也在增加。其次，从工作环境考虑，大量PC机的散热对监控中心造成较大的压力，尤其在PC机运行一段时间以后，问题更为突出，即使经常需要增加空调制冷量，仍无法彻底解决散热问题。另外，多达100台PC机长期运行产生的噪音非常大，经常在噪音中工作，对员工身体影响不好。从维护方面考虑，恢复PC机不仅要诊断、分析、更换硬件，还要连带修复操作系统和网管客户端软件，这样的低效率是不能适应网管监控工作需要的。目前，监控中心桌面系统数量多，使系统维护、故障恢复等常规保障维护工作量繁重。日常的PC机管理包括部署软件、更新系统、打补丁等，会耗费大量的人力和时间。分布式的PC机的资源利用率低下，很难集中在一起整合、分配资源，无法提高资源的利用效率、降低成本。据统计，大部分PC机的平均利用率低于5%。对于大且PC的用户还需要复杂的管理工具。而终端设备的安全漏洞也容易使IT系统受到攻击，安全隐患严重。因而，集中监控中心的桌面管理必须整合，向高安全、易维护，易使用、手段多样的模式转变。
2、桌面虚拟化技术
虚拟化技术((Virtualization)是伴随着计算机技术产生而出现的，在计算机技术的发展历程中一直扮演重要的角色。“虚拟化”是表示计算机资源的抽象方法。是为一组类似资源提供一个通用的抽象接口集，从而隐藏属性和操作之间的差异，并允许用一种通用的方式来查看并维护资源。在虚拟化技术中，虚拟的实体是各种各样的IT资源，常见的有服务器、桌面、存储设备、应用和网络等。
桌面虚拟化是将用户的桌面环境与使用终端解耦合，把操作系统、应用程序及与服务器工作负荷有关的I/O封装在一个虚拟机的文件中，服务器存放每个用户的完整桌面环境，服务器虚拟化软件让多个虚拟机可以在一台硬件服务器上运行。这些虚拟机可以取代几乎任何物理计算设备，其中包括桌面PC，换言之，桌面虚拟化技术是服务器虚拟化技术(如VMware的vSphere4)的延伸应用。实践中。将桌面系统映像存放在数据中心的服务器上面统一部署和管理，是一个可以解决集中监控中心问题的理想架构。可以说，虚拟桌面技术是应对PC桌面挑战、优化资源和管理及灵活控制总成本的有效方法。
3、集中监控中心桌面虚拟化的应用
3.1组网方案
采用虚拟桌面，承担PC工作负荷的是位于硬件服务器上的多个虚拟机中的一个，服务器则放在监控大厅以外的数据中心、远程站点(如设备机房等)。管理者可以使用计算设备(如小型瘦客户端)、显示器和键盘等外设与之相连，这种墓础架构通常称为虚拟桌面架构，即VDI——让使用者可以从数据中心部署虚拟桌面。在监控大厅内，这种模式用瘦客户机代替了普通的PC主机，降低了功耗。举例来说，一般瘦客户端的功耗只有几瓦(如Sun的Sun Ray设备的功耗只有4W)，而传统桌面PC的功耗多达250~300W。同时，这种模式还提高了安全性。虚拟桌面的操作系统包括在数据中心里面，因而比传统桌面PC更易于保护起来，避免恶意攻击，还可以从这个集中位置处理安全补丁。桌面硬件用某种瘦客户端设备取代，还能防止使用USB驱动器等可移动存储设备，提高了各类数据的保密性，并在硬件上阻止计算机病毒的带入。此外，这种模式还简化部署及日常的管理。把数据中心的桌面PC集中起来，还能让新桌面的配置速度快于传统桌面，通常只要部署封装现有虚拟桌面PC文件的副本即可。不需要前往每个工作区，就能迅速为虚拟PC打上补丁。因此。可以说在集中监控中心引入虚拟桌面环境可以解决许多问题，优化资源管理、灵活控制总成本。
集中监控中心的虚拟桌面架构分为桌面设备部分和虚拟化平台部分。系统逻辑架构如图1。
桌面虚拟化技术在集中监控中心使用可以大大降低TCO(整体成本)，并提高运营效率。首先通过服务器整合，控制和减少物理服务器的数量，明显提高每个物理服务器及其CPU的资源利用率，从而降低硬件成本。
桌面设备从原有的PC机转变为瘦客户机，而原来PC机内部的计算能力(CPU、内存、硬盘等)都通过后台机房的虚拟平台，以虚拟机的方式提供给皮客户机显示。度客户机可以看做翰入箱出设备，显示的图像都是通过网线连接到虚拟平台的一个虚拟机而获得的。这样，虽然桌面设备更换为体积更小、更节电、散热和噪音极低的度客户机，但使用感觉上没有任何差别。
桌面设备部分全部采用Sun Ray 2FS度客户机。Sun Ray系统是独立的系统，功能就是将Sun Ray瘦客户机连接到虚拟桌面。作为前端用户的交互界面.Sun Ray系统是一个三层系统，底层是Sun Ray夜客户机。中间层为负责Sun Ray启动和控制与后台连接的服务器层，上层是给Sun Ray操作系统或应用环境的服务提供层(虚拟化平台)。就监控中心的现实情况(监控中心必须是信息枢纽和集中展现中心)。每台瘦客户机都需要同时连接本地显示器和大屏幕系统，也就是需要两路外部输出，一路连接桌面显示器，另一路输出经视频线远程连接到大屏的切换矩阵上，并由XP内部的显示器设置同时将显示介面摘出到两个屏幕上。
在虚拟桌面架构中，由干桌面部分已经简化为瘦客户机，这就需要将大量原有桌面设备的处理能力集中到平台系统。而且在平台上采用虚拟技术实现。在虚拟平台上需要为每台瘦客户机配里独立的虚拟机，实现一一对应。虚拟机内部安装网管软件客户端程序及相应的操作系统。这种平台系统架构结合虚拟技术带来的极高的灵活性，对后期维护和系统部署有利。通过虚拟技术实现的高稳定性和快速故障恢复，也将提升整体系统的可用性。
虚拟化平台作为核心部分，采用VMware虚拟化平台统一支持。VMWare是一个“虚拟PC”软件。它可以使两个或更多Windows，、DOS、LINUX系统在一台机器上同时运行。与“多启动，系统相比，VMWare采用了完全不同的概念。多启动系统在同一时刻只能运行一个系统，系统切换时需要重新启动机器。VMWare是真正“同时”运行，多个操作系统在主系统的平台上，就像标准Windows应用程序那样切换。而且每个操作系统都可以虚拟分区、配里而不影响真实硬盘的数据，更可以用网卡将几台虚拟机连接为一个局域网，这一点非常符合监控中心的实际情况。
采用VMware v5phere 4建立虚拟机来提供虚拟桌面，前端用VMware vCenter与Sun VDI配合接受用户连接请求并管理连接。整个VMware虚拟平台需要部署100多个Windows XP桌面操作系统。采用虚拟桌面系统后，原有的桌面PG机替换成瘦客户机，与原有Avocent KVM系统的连接转变成瘦客户机与KVM系统的连接。此外，大屏落是监控中心必备的，如何连接也非常重要。大屏系统目前的32路视频信号有16个从KVM的控制台输入，其余16路通过PC主机连接，采用虚拟化可以选择从任意的16个Sun Ray瘦客户机接入。[
3 .2网络方案
目前内蔽移动监控中心的网络环境是在不同的网管系统之间采用了逻辑隔离的方式。在交换机上划分VLAN来保证网络安全，整体架构是：
(1)核心交换机负责维护所有VLAN信息，
(2)楼层的汇聚交换机与核心交换机之间形成Trunk连接，从而获得所有的VLAN信息。
(3)汇聚交换机上的不同端口划分在不同的VLAN内，连接在相应端口的计算机就属于这个VLAN。
由于虚拟化平台要同时支持属干不同VLAN的100多台网管客户端的虚拟机，为了更灵活的部署虚拟平台，需要将原来终结在汇聚交换机‘或接入交换机)的VLAN信息传输到虚拟平台的虚拟交换机上，在虚拟交换机上终结，这样就可以在崖拟平台灵活地将不同的虚拟机划分到不同的VLAN中。
实际部署方案如图2所示。(1)增加两台监控中心核心交换机，两台交换机通过Trunk上连楼层核心交换机井获得所有的VLAN信息。
(2)原来连接桌面设备的桌面接入交换机从直连楼层核心交换机转为连接到新配置的监控室核心交换机。
(3)所有虚拟桌面系统的服务器都连接在监控中心核心交换点上，每台虚拟平台服务器配1多个连接物理网络的端口，这些端口和监控核心交换机之间配皿为Trunk模式。Trunk链路对传物内容无任何限制，这就允许将物理交换机的VLAN信息通过这条主干链路传箱到虚拟平台的虚拟交换机上。
为了尽量少改动原有网络状态，为每个虚拟机都配里两个虚拟网卡，一个虚拟网卡连接外部的网管网络，另一个虚拟网卡连挂，Sun Ray网络。计划为Sun Ray网络配置接入交换机并使用专用网络地址(如192.168.1.X网段)，Sun Ray通过专用网络地址连接到虚拟机，虚拟机通过网管网络地址与后台网管服务器通信。
桌面虚拟化技术在集中监控中心使用可以大大降低TCO(整体成本)，并提高运营效率。首先通过服务器整合，控制和减少物理服务器的数量，明显提高每个物理服务器及其CPU的资源利用率，从而降低硬件成本。
虚拟平台的物理服务器与接入交换机连接时，需要将网卡和相应的交换机端口设里为Trunk方式，允许所有 VLAN信息的穿透。这需要改动原来交换机的设笼。综上所述，系统整体的拓扑结构如图3所示。
4、应用效果
采用痊客户机后，集中监控中心的软件部署变得简单，只藉要在中心机房统一调整就可以快速支持所有监控终端的使用。在后台的虚拟平台上，采用自动部署方式通过一些简单的设置完成批量虚拟机的创建和个性化。这与传统的在每个桌面上安装和调试每台PC机相比，效率更高，也可以便捷地实现所有客户机系统的整齐划一，便于管理维护。此外，一旦要增加新的终端，只需要在监控大厅增加一个瘦客户机、连接网线，后台将自动为其创建、分配虚拟机，可以快速创立所需的工作环境。这种快速部署、快速上线的方式是PC机传统部署方式无法比拟的。
同样，在运维管理方面，采用虚拟桌面突出的优势是管理成本明显下降。由于瘦客户机自身的稳定性极高，基本上不需要维护管理人员的维护，他们的精力可以放在数据中心的虚拟平台维护上。在虚拟平台上，管理人员可以获得原来物理平台无法实现的便捷手段，特别是通过虚拟机池的形式可以实现虚拟机增减的自动化，模版化。在功能提供方面。无论是快速支持新需求。还是处理故障后的快速恢复，虚拟平台都比传统方式更具优势。即使出现瘦客户机损坏的情况，监控人员可以随时更换位置，利用热桌面技术。无论使用哪个瘦客户机都可以直接调用自己的桌面环境。
在能耗方面，符合绿色环保要求。采用虚拟桌面后，桌面系统电能消耗将大大降低，对于24小时运行的系统来说，节能效果非常明显。经侧算，一般的虚拟桌面系统比传统PC的桌面系统节电50%以上(不同情况略有不同)，而且客户机数量越多，效果越明显。在虚拟平台上，大的部署密度使一台服务器可以同时支持数十个虚拟机运行，高密度也提高了服务器自身电能的利用率。这无疑解决了集中监控中心的能耗、散热和噪音等机房环境问题，为改善工作环境有很大好处。
5、总结
桌面虚拟化技术在集中监控中心使用可以大大降低TCO(整体成本)，并提高运营效率。首先通过服务器整合，控制和减少物理服务器的数量，明显提高每个物理服务器及其CPU的资源利用率，从而降低硬件成本。其次，降低运营和维护成本，包括数据中心空间、机柜、网线，耗电量，冷气空调和人力成本等。此外，虚拟化技术还可以实现系统整体的负载均衡及高可用性。如果二个系统的某一台服务器负载过大，可以使用虚拟化技术动态调整负载。同时，虚拟化技术还可以在服务器停机和维修的时候，把相关的系统快速平滑地迁移到其他服务器上，这对于系统灾难备份也有很大意义，可以确保应用系统的业务连续性。