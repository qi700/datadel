SVC 存储虚拟化在容灾系统中的应用研究
本文结合已实施完成的容灾系统建设项目,介绍了基于SVC存储虚拟化的数据复制技术在容灾系统中的建设方案和实施方法,并对该应用方式的特点进行了分析总结。1 前言     随着信息化建设进程的加快,各单位在信息化建设方面取得了很大发展。目前,笔者所在单位在日常办公、财务管理、人事管理、标准网、档案管理、固定资产管理以及各科研生产管理等诸多方面全面使用信息系统。近几年来,上述信息系统的数据量迅速增长,业务数据的重要程度日益增加,任何重要信息的丢失都将会给科研生产带来难以估计的损失和影响。因此,如何保证核心科研生产系统的业务连续性和数据的安全性,如何对现有信息系统进行灾难备份建设,成为单位信息系统当前迫切需要解决的两大课题。为了解决以上问题,本单位开展了容灾系统的建设工作,并成功完成实施和应用,取得较好效果。 2 基于存储虚拟化的数据复制技术在容灾系统建设中的应用     本容灾系统建设过程中,笔者所在项目组从业务连续性保护策略的高度,分别确定了容灾系统建设的总体框架模型策略、数据复制设计策略、网络切换设计策略、应用程序同步设计策略、时间同步设计策略、业务连续运维流程和组织结构制定策略,这些策略是建设容灾系统的重要依据和基础。其中数据复制设计的策略制定及实施效果将直接影响容灾系统成功与否。     2.1 容灾系统数据复制技术方案     业界有多种数据复制技术,这些主流的数据复制技术中,没有哪一类技术比另外一类技术更具有绝对的优势,只要是能够满足企业特定需求的技术,就是最好的选择。根据对主流数据复制技术的研究和应用,结合本单位核心业务系统的特点和容灾系统建设目标,对可以采用的主机层数据复制、存储网络层数据复制、存储层数据复制三种数据复制及容灾方案进行了比较。分别从技术架构的设计、实现、实施以及后期运行维护多角度对三种方案进行了比较,并最终选择了基于存储网络复制的容灾方案。     为充分利用商用成熟技术,本容灾系统建设采用了基于存储网络虚拟化的IBMSVC存储虚拟化产品,缩短了建设周期,提高了系统的成熟度和可靠性。     2.2 基于存储虚拟化的数据复制技术途径     虚拟存储是一种具有智能结构的系统,它允许以透明的方式有效在磁盘和磁带上存储数据,统一管理磁盘空间。在虚拟存储环境下,无论后端物理存储是什么设备,服务器及其应用系统看到的都是其物理设备的逻辑映像。即使物理存储发生变化,这种逻辑映像也不会改变,系统管理员只需专注管理存储空间的划分、分配、保护策略的管理,存储虚拟化产品负责响应管理指令,将指令映射到实际物理存储。     IBM System Storage SAN卷控制器[1N Volume Controller,简称SVC]存储虚拟化产品实现虚拟存储。SVC是一个软硬件集成化的产品,SVC集成了IBM服务器、基于Linux kernel的存储操作系统以及专业的虚拟存储软件。SVC融合了存储业界突破性技术,通过创建共享的存储池聚集不同存储系统来提供的统一容量,实现异构磁盘系统的有效整合与集中管理。SVC提供适用于市面上主流存储系统的通用拷贝功能,允许在不关闭应用服务器的情况下动态转移数据。SVC是整个SAN网络的控制器,将整个SAN中的各种存储设备整合成一个巨大的“存储池”,使得用户充分利用存储资源并可按需分配存储空间、性能和功能,SVC的主要功能包括:     (1)构建统一、合理的、高可扩展的存储架构;     (2)集中管理存储系统,把多个存储系统整合成单一的存储池,兼容市面上常见主机系统和存储产品;     (3)简化各种复杂的存储系统管理,可通过GUI(图形界面)管理所有存储系统;方便用户实施分级存储;     (4)迁移过程无需停机,支持7X24小时业务不间断运行,迁移过程主机系统和应用不受影响;     (5)提供快照、数据复制等功能,提供跨存储及跨地域的数据保护功能;SVC通过冗余组件使系统具有极高的可靠性,可用性以及高服务性,图1所示为SVC拓扑图。   图1 SVC 拓扑图     本容灾系统的容灾中心与数据中心间距离相对较短(<1000m),在容灾中心与数据中心各部署一套存储阵列,其中配置1台EMC DMX4-950磁盘阵列作为现有EMC DMX1000的镜像阵列,部署在容灾机房。EMC DMX1000和EMC DMX4-950互为容灾存储镜像备份;一对IBM 存储虚拟控制器SVC(2节点,可扩展到8节点),数据中心和容灾机房各部署一台,每台连接本端和远端的光纤交换机,组成虚拟化存储网络。通过服务器集群技术将应用跨两个机房,其中数据库服务器采用IBM P750,部署ORACLE10GRAC。应用服务器采用sun E4900,部署sun cluster,当系统中一个机房的部分设备在出现问题或整体发生灾难时,可以自动实现集群系统切换。同时,在容灾系统的建设过程中,将结构化数据和非结构化数据迁移至EMC DMX 1000阵列和EMC DMX4-950磁盘阵列构成的镜像存储平台上,实现所有业务数据的集中和整合。根据技术方案设计与设备配置情况,核心系统容灾的主要设备物理连接见图2所示。   图2 容灾系统与业务系统物理连接图     本项目实施涉及到存储设备整合、数据库平台整合、应用HA集群搭建过程,且是针对现有的在线核心应用进行,风险系数较大。为规避风险,项目组在实施前构建了应用集群的测试平台,将部署过程做正确性的验证后再进行实际操作。未来常规的系统运维过程中,测试平台也将用于新的应用功能上线时测试使用,把功能的正确性测试对在线应用的影响降至最低。本次容灾系统建设采用的基于SVC存储虚拟化的数据复制技术,具有如下优点。     (1)采用存储虚拟化技术,方案成熟,架构稳定;(2)数据复制对主机系统完全透明,无须占用主机资源。(3)管理简单,实现存储系统的单一界面管理,透明实现数据跨机房容灾。(4)利用SVC快照数据,能够有效支撑容灾中心可用性验证、报表、查询类业务的分离等功能,有效地规避人为误操作类风险。 3 结语     军工单位数据中心及涉密信息系统建设过程中,系统容灾建设日趋重要和紧迫,现有商用技术的迅猛发展是可利用的工具和手段,建议在容灾系统建设项目中,兼顾成熟性、先进性、对现有资源的综合利用等多个方面。本文采用的SVC存储虚拟化设备应用于容灾系统建设,经过一年多的实际运行,系统稳定、可靠,达到了建设目标。