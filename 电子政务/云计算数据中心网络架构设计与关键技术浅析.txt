云计算数据中心网络架构设计与关键技术浅析
关键词：云计算 数据中心 大二层网络 虚拟化 FCOE  IPV6 摘要：云计算时代，开启IT 革新，网络变革应“云”而生，云计算将给数据中心网络带来结构性变化，设计一种适应云计算的下一代网络架构和技术标准势在必行。本文在总体上对云计算数据中心的下一代网络架构设计进行了结构性分析，并对云计算网络关键技术进行了全面的剖析。首先对云计算的基本架构和分类进行简单描述；进而根据云计算的特点和对下一代网络的需求，对数据中心网络进行总体架构设计，再分别对架构中网络的虚拟化和网络VM 之间、跨站点之间互访、多站点选择技术进行深入分析；其次介绍了云计算数据中心后端存储网络及FCOE 技术；最后展望了云计算和IPV6 的结合趋势。    云计算，开启IT 革新，网络变革应“云”而生，云计算将给数据中心网络带来结构性变化，设计一种适应云计算的下一代网络架构和技术标准势在必行。云计算时代，一切都将发生根本性变革，网络作为IT 基础设施平台，其整体架构、设备组件、协议选择、关键技术都将发生根本性革新。    1.云计算基本架构    云计算的概念并不具体，各方面定义很多，以使用者的视角来看，就是让用户在不需了解资源的情况下得到按需分配，计算资源被虚拟化为一片云。当前主流的云计算概念更贴切于云服务，现在提供租用服务的是虚拟机，是软件平台，更可能是应用程序。    1.1 云计算的五大特性    云计算的五大特性分别是用户按需的自助服务；任何时间、地点和接入方式均可到云计算所提供服务的广泛网络访问；有需占用无需释放的池化资源；及时响应用户资源需求扩张和收缩调度的良好弹性；提供运营公用服务、使用资源的计时计量的计费服务。    1.2 云计算分层架构    云计算服务的三个层次分别是硬件即服务IaaS（Infrastructure as a Service）、平台即服务PaaS（Platform as a Service）和软件即服务SaaS（Software as a Service），分别对应于硬件资源、平台资源以及应用资源。    1.3 集中云、分散云    集中云即真正意义上的多虚一，是将几百上千台或更多服务器资源集结、统一计算，对外提供服务，云技术上分为主备和负载均衡两类。主要应用于国家级应用和大型互联网服务提供商。    分散云，使用一虚多技术，是通过类似于VMware 软件将一台服务器或者PC 分成多个虚拟机，使CPU、内存和带宽达到最高的利用率，目前主要技术包括操作系统虚拟化、主机虚拟化和Bare-Metal 虚拟化。主要应用于中小企业和个人。    1.4 公有云、私有云    公有云是放在Internet 上的，只要是注册用户、付费用户都可以用。    私有云是放在私有环境中的，比如企业、政府、组织等自行在机房中建立的，或是运营商建设好，但整体租给某一组织的。企业、组织、政府等之外的用户无法访问或无法使用。    2.云计算数据中心大二层网络架构    2.1 网络大二层架构设计    2.1.1 设计原则    1) 高可用性：为了保障对云计算终端用户提供最安全、最可靠的数据存储中心，网络平台必须确保高可靠的网络接入服务，实现“永远在线”的网络连接；    2) 易用性：网络平台需有不同终端、接入方式的良好兼容性，使计算服务范围最大化，同时降低、简化对用户终端的设备的要求，使用户能以“任何终端、位置、方式”获得云计算服务；    3) 可扩展性：网络平台必须适应云计算发展，具备可扩展性，能灵活接入新云计算中心、新终端，快速提供服务。    2.1.2 大二层架构    下一代网络平台使用大二层架构，如图1 所示，分为接入层和核心层。随着云计算数据中心网络规模的扩大、更大的流量带宽需求，网络中间不会再有使转发性能变低的瓶颈汇聚层。现如今可以说，云计算数据中心典型架构均为上图所示的千兆接入，万兆核心的两层扁平化网络结构。图1 公有云的大二层网络平台架构    2.2 云计算对下一网络技术的需求    1) 服务器之间的东西流量将成为主流，网络二层流量需求增加。    2) 虚拟机以及物理服务器数量增加，导致网络二层拓扑将不断变大。    3) 数据中心内部通信的压力增大，对网络带宽和延迟有了更高的要求。    4) 扩容需求、灾难备份和虚拟机迁移，数据中心多站点间网络大二层要求互通。    5) 数据中心多站点的网络选路复杂性提高。    3.云计算网络虚拟化和互访    云计算中的虚拟化应包括计算的虚拟化、存储虚拟化和网络的虚拟化。随着计算和存储的虚拟化不断实现，网络虚拟化技术的必要性和重要性不断凸显，在未来十年中必会成为网络技术发展的重中之重，其发展及变化也必将成为引领数据中心网络的演进方向。    3.1 网络多虚一    1) 控制层面虚拟化：是将所有设备的控制平面合而为一成为一个主体，统一处理整个虚拟交换机的工作，统一管理与接口扩展的需求。从结构控制平面虚拟化又分为纵向即不同层次设备虚拟化和横向同一层次设备虚拟化。    2) 网络层面虚拟化：使用了TRILL 和SPB 协议，在二层网络转发时，对报文进行外层封装，以Tag 方式在TRILL/SPB 区域内部转发，此区域网络形成一个大的虚拟交换机，实现对报文的透明转发。    3.2 网络一虚多    传统的网络一虚多技术包括因特网的VLAN 技术、IP 的VPN 技术、FC 的VSAN 技术等，目前出现的较新的技术是CISCO 的VDC，最多实现4 个VDC 将物理资源独立分配。    3.3 网卡的虚拟化    还有一种网络的虚拟化补充技术是服务器网卡的IO 虚拟化技术即SR-IOV，由PCI SIG工作组提出的。SR-IOV 就是要在服务器物理网卡上，建立多个虚拟IO 通道，并使其能够直接一一对应到多个虚拟机的虚拟网卡上，用以提高虚拟服务器的转发效率。    3.4 数据中心内虚拟机之间的网络互访    在本文3.1和3.2中，对网络虚拟化实现网络中跨核心服务器的二层互访技术进行剖析，如图2 中的Network3 所示链路，此节则分析VM（Virtual Machine，虚拟机）之间的互访技术，如图2 中的Network1 所示链路。图2 云计算数据中心的网络互访    在数据中心，服务器一虚多后内部VM之间的互访越发频繁，其在技术上分为物理服务器本地互访和交换机VM 互访。前者通过Vswitch（软件交换机）解决一台服务器内部的VM 网络互访，但是缺点是不易管理，同时占用服务器CPU，降低了效率；后者，是真正意义上的云网络接入末端，将网络深入到服务器内部，使网络形成统一管理和统一交换的平台，将成为云计算网络VM互访的主流技术。    在管理层面，交换机VM本地互访是把网络中所有与交换、寻址有关的内容都虚拟化成为一台逻辑的交换机，进而对其进行统一管理；在数据层面，交换机为每个VM提供一个虚拟接口，使用服务器网卡的虚拟化SR-IOV 或者增加交换机做软件驱动，主流的技术体系标准如802.1Qbg 和802.1Qbh。    VM之间互访技术，会以硬件交换机进入服务器内部为最终方向，或是在网卡上实现，或是直接在主板上加转发芯片。    3.5 数据中心网络跨站点的二层互访和多站点选择    2.5.1 数据中心网络跨站点的二层互访    在集中云计算数据中心，存在三个或以上多站点服务器集群计算，以及在分散云情况下，会有虚拟机的迁移变更（VMotion）的需求，此时则需要数据中心网络的跨站点二层互访，如图2中的Network4所示链路。二层网络互访的实现，有三种方式即采用光纤直连的星形或者环形拓扑、使用MPLS 技术搭建网络、使用安全加密机制的IP 因特网。从性价比、成本节约和可靠性设计的角度看，多站点的光纤直连优势明显，但因目前光纤直连都是各企事业为某种业务单独建立，缺少公用标准的建立。    2.5.2 数据中心网络多站点选择    在云计算数据中心多站点网络里，用户访问服务器存在多站点的选路问题，如图2 中的Network5 所示链路。多站点的选择方案有两种，一种DNS 技术，应用全局负载均衡GSLB技术和虚拟机迁移技术实现；一种是基于IP 的路由转发，利用LSIP（Locator/ID Separation Protocol 位置标识/身份标识分离协议技术实现路由选择，它提供了一种数据包路由方法，可以在不改变终端软件的前提下实现虚拟机在服务器之间的无缝迁移。    4.云计算数据中心后端存储网络    4.1 传统的存储网络    传统的存储方式包括DAS、NAS、SAN、FC SAN，其中DAS（Direct Attached Storage）是直连磁盘存储，NAS（Network Attached Storage）是网络共享文件服务器，上升到数据中心级别，则出现SAN（Storage Area Network），通过FC 或者TCP/IP 网络，将磁盘阵列注册于服务器，模拟成直连存储，FC SAN 则是目前最主流的霸主技术。    4.2 前后端融合 FCoE    因特网与FC的融合，就是FCoE（Fiber Channel over Ethernet）以太网的光纤通道，如图2 中的Network2 所示链路，边界依然是接入交换。在服务器物理网卡到接入交换这部分，通过接入交换机，将FC的数据承载在某个VLAN 中进行传输。FCoE 技术标准可以将光纤通道映射至以太网，同时在以太网信息包内插入光纤通道信息，让服务器和SAN 存储设备之间的光纤通道请求和数据，通过以太网连接来进行传输，即在以太网上传输SAN 数据。FCoE 后端融合网络同时支持LAN 和SAN 数据传输，减少数据中心设备和线缆数量，同时降低供电和制冷负载，收敛成统一的网络后，减少了支持的点数，降低管理负担。它同时能够保护现有投资，提供了一种以FC 存储协议为核心的I/O 融合方案。    5.云计算与 IPV6    云计算的发展对网络安全性提出更高的要求，IPv6 技术的安全机制、巨大的地址空间、可溯源技术、定义多播地址等技术，都在一定程度上改善了网络层的安全性，同时在使用IPv6 的网络中用户可以对网络层的数据进行加密并对IP 报文进行校验，又极大的增强了网络的安全性；云计算的发展使得网络规模进一步扩大，我国物联网、移动互联网、云计算、三网融合等产业的发展都需要海量的IP 地址作为支撑，而IP 地址严重不足，已成为制约我国产业发展的瓶颈，IPv6 大大增加了地址空间，是适应云网络发展的方向；另外，IPv6 集成的安全和质量的服务机制，以及自动配置和移动性的支持，更高路由稳定性更给云计算网络的可管可控以及可靠性带来保障。    结束语    据统计，IT每大概15年就会发生一次演变，新需求和创新技术结合，使计算方式不断发生根本性改变，从大型主机计算到互联网，逐渐进入虚拟化时代，云计算、虚拟化、高速增长数据、融合和移动性，这些需求不断选择着网络技术和发展方向，作为IT 基础平台，网络架构和关键技术直接影响着IT 时代轴承上新需求的实现，决定其演变的进程。在虚拟化时代，云计算数据中心大二层网络架构配合相应关键技术，以其扁平化、高效率、高带宽、互连互通、扩展灵活、安全可靠的优势，终将成为符合IT 时代特征的网络发展的必然趋势。
参考文献：  1、姚宏宇，田溯宁.《云计算：大数据时代的系统工程》.电子工业出版社.2013. 2、彭国庆， 周冠.“云计算分层体系结构的研究”.移动通信，2010.  3、卢强. “云计算环境下的泛联路由平台发展的架构与特征”，比特网，2012. 4、“51CTO论坛”，“云计算数据中心网络技术全面剖析”，51CTO网站，2011.