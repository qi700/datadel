几种常见网络存储备份方式浅析
网络数据信息爆炸性的增长，使网络存储技术变得越来越重要，已成为Internet及其相关行业进一步发展的关键。本论文主要讲述了常用离线存储备份技术的结构选择、技术演进、常用实施方策及各种方策的优缺点。    1.引言    信息是一个企业可持续发展的核心动力之一，信息的可靠存储是一个企业得以正常运作和发展壮大的根本所在。信息化给人们带来快捷的服务和方便的管理时，也给人们带来数字信息丢失的风险。数据的丢失会中断企业的正常运行，同时也会给企业造成巨大的经济损失。因此，数据的存储、备份成为保证数据安全的重要措施。    存储备份(也称为数据备份)是容灾的基础，一切容灾系统的建立都是以数据备份为基础的。而建立容灾系统的最终目的不是备份，而是快速恢复数据。存储备份系统一般使用磁带库设备和存储备份软件，它是整个容灾体系中重要的后备支撑。当数据受到破坏，存储备份系统的任务就是把由数据丢失而造成的灾难降到最低，并在最短的时间内将系统中丢失和破坏的数据全部恢复，使系统能正常运行。    存储备份分为两大类，一种是离线备份(Offline)，如LAN-free， Server-free，即把存储服务器中的数据备份到磁带库中。采用这种备份方式，数据恢复的时间要比在线方式长，但它的投资较小，只要有存储备份设备和存储备份软件即可；另一种是在线备份(on-line)，如数据复制。数据复制实际上就是一种同步的数据备份，其数据恢复的时间非常短，短则几秒、几分钟不等。数据复制是一个高级的同步过程，可使数据全整的保存，达到一点都不丢失的状态。在现在的大部份用户中，绝大部份用户使用数据离线备份即可。只有其业务需要连续性的关键业务用户，才会使用在线备份。本文主要阐述离线备份技术的实施手段和优缺点。    2.存储技术的结构选择    目前，存储数据的方式常见的有二种：    2.1 DAS    DAS(Direct Attached Storage)即直接连接存储技术，是指将存储设备通过SCSI接口或光纤通道直接连接到服务器上的方式。这种连接方式主要应用于单机或两台主机的集群环境中，现在在各大银行的中心业务系统中常能见到这种方式。    2.2 NAS    NAS(Network Attached Storage)即网络附加存储方式，将存储设备通过标准的网络拓扑结构例如(以太网)，连接到一群计算机上，提供数据和文件服务。NAS服务器一般由存储硬件、操作系统以及其上的文件系统等几个部分组成。此为以专业的网络文件存储及文件备份为中心的方式，是现在以文件存储为主的一种存储方式。    2.3 SAN    SAN (Storage  Area Network)即存储局域网，是指存储设备相互连接且与一台服务器或一个服务器群相连的网络，通常有FC-SAN和工P-SAN两种架构。存储区域网络是一种专用的，集中式管理的并且是具有安全性的信息系统构架，存储区域网络能够实现服务器和存储设备之间的任意互联。SAN是一个由多厂商存储设备，存储管理软件，应用服务器以及网络硬件设备构成的高速的存储网络，它能够辅助用户更有效地利用其业务信息。    3.备份方式的技术演进    3.1 本机备份    在传统的备份模式卜，每台主机都配备专用的存储磁盘或磁带系统，主机中的数据必须备份到位于本地的专用磁带设备或盘阵中。这样，即使一台磁带机(或磁带库)处于空闲状态，另一台主机也不能使用他进行备份工作，磁带资源利用率较低。另外，不同的操作系统平台使用的备份恢复程式一般也不相同，这使得备份工作和对资源的总体管理变得更加复杂。    3.2 网络备份    后来，产生一种克服专用磁带系统利用率低的改进办法：即磁带资源由一个主备份/恢复服务器控制，而备份和恢复进程由一些管理软件来控制。主备份服务器接收其他服务器通过局域网或广域网发来的数据，并将其存入公用磁盘或磁带系统中。    网络备份/恢复 图1 网络备份    3.3 先进备份方式    随着信息量呈爆炸性增氏，大量的系统数据通过用户网络进行备份，使网络带宽成为难以逾越的瓶颈。有没有一种更先进的解决方案，在备份的时候尽可能减小对系统资源的消耗，同时又确保系统的高可用性和灵活性呢?    3.3.1 LAN-free备份    办法之一是采用LAN-freea所谓LAN-free，是指数据不经过局域网直接进行备份，即用户只需将磁带机或磁带库等备份设备连接到SAN中，各服务器就可把需要备份的数据直接发送到共享的备份设备上，不必再经过局域网链路。由于服务器到共享存储设备的大量数据传输是通过SAN网络进行的，局域网只承担各服务器之间的通信(而不是数据传输)任务。    Lan-free备份/恢复 图2 Lan-free备份    3.3.1.1 LAN-free备份常用实施方式    通常，用户都需要为每台服务器配备光纤通道适配器，适配器负责把这些服务器连接到和一台或多台磁带机(或磁带库)相连的SAN上。同时，还需要为服务器配备特定的管理软件，通过它，系统能够把块格式的数据从服务器内存、经SAN传输到磁带机或磁带库中。    更有一种常用的LAN-free实施办法，在这种结构中，主备份服务器上的管理软件能够启动其他服务器的数据备份操作。块格式的数据从磁盘阵列通过SAN传输到临时存储数据的备份服务器的内存中，之后再经SAN传输到磁带机或磁带库中。    3.3.1.2 LAN-free备份不足    LAN-free技术也存在明显不足。首先，他仍}口让服务器参与了将备份数据从一个存储设备转移到另一个存储设备的过程，在一定程度上占用了宝贵的CPU处理时间和服务器内存。更有一个问题是，LAN-free技术的恢复能力差强人意，他很依赖用户的应用。许多产品并不支持文档级或目录级恢复，映像级恢复就变得较为常见。映像级恢复就是把整个映像从磁带拷回到磁盘上，假如您需要快速恢复某一个文档，整个操作将变得很麻烦。此外，不同厂商实施的LAN-free机制各不相同，这还会导致备份过程所需的系统之间出现兼容性问题。    3.3.2 Server-Less备份    办法之一就是采用Server-Less。顾名思义Server-Less就是绕过服务器的备份，具体地说就是在执行备份操作时，备份数据是直接从磁盘上写入到磁带中，在整个过程中对LAN网络和应用服务器毫无影响。这使得网络的负载和应用服务器真正从备份中解放出来。这种方案的主要氏处之‘是无需在服务器中缓存数据，显著减少对主机CPU的占用，提高操作系统工作效率，帮助企业完成更多的工作。    3.3.2.1 Server-Less备份常用实施方式    通常情况下，备份数据通过名为数据移动器的设备从磁盘阵列传输到磁带库上。该设备可能是光纤通道交换机、存储路由器、智能磁带或磁盘设备或是服务器。数据移动器执行的命令其实是把数据从一个存储设备传输到另一个设备。实施这个过程的一种方法是借助于SCSI-3的扩展拷贝命令，他使服务器能够发送命令给存储设备，指示后者把数据直接传输到另一个设备，不必通过服务器内存。数据移动器收到扩展拷贝命令后，执行相应功能。    另一种方法就是利用网络数据管理协议(NDMP)。这种协议实际上为服务器、备份和恢复应用及备份设备等部件之间的通信充当一种接口。在实施过程中，NDMP把命令从服务器传输到备份应用中，而和NDMP兼容的备份软件会开始实际的数据传输工作，且数据的传输并不通过服务器内存。NDMP的目的在于方便异构环境卜的备份和恢复过程，并增强不同厂商的备份和恢复管理软件连同存储硬件之间的兼容性。    3.3.2.2 Server-Less备份的优势    由于服务器瓶颈己不存在，备份将更快。    专用的备份服务器被省略。    兼做备份及文件的服务器能将全部的能力用于业务处理。    由于数据被直接送到磁带设备而不受服务器性能的限制，磁带机的速度被发挥到最佳。    能在任何时候进行备份并不会对用户网络造成影响，真正实现7X24小时全大候备份。    无服务器备份的好处在数据恢复时得到体现。由于网络“快照”执行起来更方便，所以备份磁带能包含最新的数据，这样恢复得也就更快，要做的工作也就更少。    3.3.2.3 Server-Less备份的不足    虽然服务器的负担大为减轻，但仍需要备份应用软件(连同其主机服务器)来控制备份过程。儿数据必须记录在备份软件的数据库上，这仍需要占用CPU资源。和LAN-free相同，无服务器备份可能会导致同样类刑的兼容性问题。而且，无服务器备份可能难度大、成本高。最后，假如无服务器备份的应用要更广泛，恢复功能方面更有待更大改进。    4.结束语    数据的重要性越来越得到人们的广泛认同。未来网络的核心将是数据，网络化存储正是数据存储的一个发展方向。这里我们简要的介绍了几种当前比较流行的网络存储技术及备份技术，当前网络存储技术还在不断的快速发展，SAN和NAS的融合、统一虚拟存储技术是未来发展的两个趋势。