数据备份与恢复技术在门户中的应用
数据是大庆油田设计院企业信息门户中最重要的组成部分，对门户的数据备份至关重要。对企业门户的数据备份可采用Microsoft Office SharePoint Designer、MOSS “管理中心”、stsadm.exe 命令行、SQL Server 数据库备份四种方式进行。在日常的工作中，通常将这四种方式结合使用，高效地完成了门户的数据备份任务。    大庆油田设计院企业信息门户网站是中石油企业信息门户整体框架下的一个企业信息子门户。该门户网站在Intranet 环境下，在Share Point 平台架构上，把各种应用系统、数据资源和互联网资源统一到同一门户之下，根据每个用户使用特点和角色的不同，形成个性化的应用界面，并通过对事件和消息的处理、传输把用户有机地联系在一起。企业信息门户的价值在于企业能够释放存储在企业内部的各种信息，使企业员工、用户和合作伙伴能够利用单一的渠道访问所需的个性化信息，从而发挥这些信息的最大价值，使之真正成为企业的财富。    数据是企业信息门户中最重要的组成部分，所以对门户数据的备份显得尤为重要，应该在灾难发生前进行还原演练与测试，以便保护重要数据，将损失降到最低。内容还原常用于最终用户的数据更新或者删除的还原；灾难还原仅在致命的灾害发生时进行，通常包括更换硬件和重新安装配置软件，此方式需要提供完整的服务器或数据库。    大庆油田设计院企业信息门户常用的备份还原方式有以下几种：使用Microsoft Office Share Point Designer；使用stsadm.exe；使用MOSS “管理中心”；SQL Server 数据库备份还原。    使用Microsoft Office Share Point Designer：备份。将数据备份至cmp 文件，然后从备份文件中重新创建内容或网站。但此方法要求网站数据不能超过24 M，且不包含在网站集级别存储工作流配置、通知和属性、回收站状态和回收站中的内容，具体操作如下：用Share Point 打开要门户，点击菜单“网站”/“管理”/“备份网站”（可以选择“存档中包含子网站”来包含要备份门户下的子门户）。    还原。首先在Share Piont 中新建一个空白网站，然后点击菜单“文件”/“新建”/“网站”，选择“常规”中的“空白网站”，并在下面的“指定新网站的位置”里填入新网站的地址，点击确定后创建一个新的网站，然后点击菜单“网站”/“管理”/“还原网站”，并选择电脑上存储的备份文件即可。    使用stsadm.exe ：此方法可一次性备份或还原门户（包括门户内容，如网站、文档版本、列表和用户等）。    备份。在MOSS 服务器上以命令行方式进行，命令行参考： stsadm.exe-o backup-url +网站地址+备份文件名-overwrite。    还原。在MOSS 服务器上以命令行方式进行，命令行参考： stsadm.exe-o restore-url +网站地址+备份文件名-overwrite。如果要还原的是子网站，需将restore 替换为import，url 后面输入子网站的地址，并且不能使用-overwrite 参数。    使用MOSS“管理中心”：该方法可针对整个服务器的所有配置和网站，适于服务器尚能工作时的数据恢复。    备份。用浏览器访问MOSS 服务器的“管理中心”，在“操作”中的“备份和还原”中，点击“执行备份”，首先选中需要备份的内容，然后指定备份类型和备份文件存放的目的地，系统将进入“备份和还原状态”页面，并会自动刷新该页面的状态直至完成备份。    还原。通过浏览器访问MOSS 服务器的“管理中心”，在“操作”中的“备份和还原”下，点击“从备份还原”，选择备份文件位置及备份记录后，选中还原选项，点击“确定”后，系统即自动完成还原操作。    SQL Server 数据库备份还原：此方法适合将门户从测试服务器场迁移到正式服务器，或者备份和还原服务器里的站点。    备份。SQL Server 可以通过日志备份的方式在恢复时恢复到指定的时间点。但此方式不能备份和还原以下内容：发布到WSS 站点的自定义的应用程序；备用访问映射；IIS metabase 可以备份但不能还原以下内容：①Share Point 配置数据库Share Point_Config；②管理中心IIS 站点和应用程序；③管理中心数据库Share Point_ Admin Content。具体操作如下：利用SQL Server Management studio 连接数据库服务器，打开“维护计划向导”，选择需备份的数据库名称，并选择备份位置。根据需要选择“完整”、“差异”、“事物日志”三种备份方式中的一种（一般完整备份在每周末进行一次，日志备份和差异在每天晚上进行），点击“下一步”即完成了维护计划的定制。    还原。首先在SQL Server Enterprise Manager中，还原所有之前备份的Share Point 相关的数据库，然后通过管理中心新建立一个web 应用程序，并删除所关联的内容数据库，最后还原新站点、SSP的内容数据库、还原SSP。